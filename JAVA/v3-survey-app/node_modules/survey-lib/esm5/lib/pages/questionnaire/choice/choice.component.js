/**
 * @fileoverview added by tsickle
 * Generated from: lib/pages/questionnaire/choice/choice.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { Question } from '../../pages.model';
import { SurveyResponses } from '../../survey-response.model';
import { PagesService } from '../../../shared/pages-services/pages.service';
var ChoiceComponent = /** @class */ (function () {
    function ChoiceComponent(pageService) {
        this.pageService = pageService;
        this.isActive = false;
        this.submitEvent = new EventEmitter();
    }
    Object.defineProperty(ChoiceComponent.prototype, "isMultipleChoice", {
        get: /**
         * @return {?}
         */
        function () {
            return this._isMultipleChoice;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._isMultipleChoice = value;
            console.log('Inside isMultipleChoice');
            console.log(value);
            this.choiceQuestion.choices.forEach((/**
             * @param {?} choice
             * @return {?}
             */
            function (choice) { return choice.isChecked = false; }));
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ChoiceComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        console.warn(this.surveyResponse);
        if (this.surveyResponse.choices !== undefined) {
            this.surveyResponse.choices.forEach((/**
             * @param {?} choice
             * @return {?}
             */
            function (choice) { return choice.isChecked = true; }));
        }
        if (this.pageService.stage == 'entry-next') {
            document.getElementById('choice-question').className = 'entry-next';
            document.getElementById('choice-question-delay').className = 'entry-next-delay';
        }
        else if (this.pageService.stage == 'entry-previous') {
            document.getElementById('choice-question').className = 'entry-previous-delay';
            document.getElementById('choice-question-delay').className = 'entry-previous';
        }
    };
    /**
     * @return {?}
     */
    ChoiceComponent.prototype.submit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.isActive = true;
        this.surveyResponse.choices = this.selectedOptions;
        if (this.surveyResponse.choices != undefined &&
            this.surveyResponse.choices.length > 0) {
            this.surveyResponse.questionId = this.choiceQuestion.questionId;
            this.surveyResponse.question = this.choiceQuestion.question;
            this.surveyResponse.questionType = this.choiceQuestion.questionType;
            this.surveyResponse.identifier = this.choiceQuestion.identifier;
            this.pageService.persistSurvey(this.surveyResponse);
        }
        document.getElementById('btn-primary').classList.add('blink-btn-animation');
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.submitEvent.emit();
        }), 350);
    };
    Object.defineProperty(ChoiceComponent.prototype, "selectedOptions", {
        get: /**
         * @return {?}
         */
        function () {
            return this.choiceQuestion.choices
                .filter((/**
             * @param {?} choice
             * @return {?}
             */
            function (choice) { return choice.isChecked; }))
                .map((/**
             * @param {?} opt
             * @return {?}
             */
            function (opt) { return opt; }));
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @private
     * @param {?} choices
     * @return {?}
     */
    ChoiceComponent.prototype.changeSelection = /**
     * @private
     * @param {?} choices
     * @return {?}
     */
    function (choices) {
        var _this = this;
        if (typeof choices !== 'undefined') {
            choices.forEach((/**
             * @param {?} choice
             * @return {?}
             */
            function (choice) {
                _this.choiceQuestion.choices.forEach((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) {
                    if (choice.choiceId == c.choiceId) {
                        c.isChecked = true;
                    }
                }));
            }));
        }
    };
    /**
     * @return {?}
     */
    ChoiceComponent.prototype.onClickOthers = /**
     * @return {?}
     */
    function () {
        if (!this.choiceQuestion.others.isChecked) {
            this.choiceQuestion.others.isChecked = true;
            this.choiceQuestion.others.showCheckbox = false;
        }
        else {
            this.choiceQuestion.others.isChecked = false;
            this.choiceQuestion.others.showCheckbox = true;
        }
    };
    /**
     * @return {?}
     */
    ChoiceComponent.prototype.onInputOthers = /**
     * @return {?}
     */
    function () {
        this.choiceQuestion.others.isChecked = true;
        this.choiceQuestion.others.showCheckbox = true;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ChoiceComponent.prototype.onOptionSelectionChange = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event) {
            this.choiceQuestion.attributes.numberOfSelection++;
        }
        else {
            this.choiceQuestion.attributes.numberOfSelection--;
        }
    };
    /**
     * @param {?} identifier
     * @return {?}
     */
    ChoiceComponent.prototype.onSingleSelect = /**
     * @param {?} identifier
     * @return {?}
     */
    function (identifier) {
        this.choiceQuestion.choices.forEach((/**
         * @param {?} choice
         * @return {?}
         */
        function (choice) { return choice.isChecked = false; }));
        /** @type {?} */
        var index = this.choiceQuestion.choices.findIndex((/**
         * @param {?} choice
         * @return {?}
         */
        function (choice) { return choice.identifier == identifier; }));
        if (index > 0) {
            this.choiceQuestion.choices[index].isChecked = true;
        }
    };
    /**
     * @param {?} choice
     * @return {?}
     */
    ChoiceComponent.prototype.isDisabled = /**
     * @param {?} choice
     * @return {?}
     */
    function (choice) {
        if (this.choiceQuestion.attributes.selection == undefined)
            return false;
        else if (this.choiceQuestion.attributes.selection.type == 'Exact') {
            return this.choiceQuestion.attributes.numberOfSelection >= this.choiceQuestion.attributes.selection.exact
                && !choice.isChecked;
        }
        else if (this.choiceQuestion.attributes.selection.type == 'Range') {
            return this.choiceQuestion.attributes.numberOfSelection >= this.choiceQuestion.attributes.selection.rangeTo
                && !choice.isChecked;
        }
        else
            return false;
    };
    ChoiceComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-choice',
                    template: "<div id=\"choice-question\">\n\n  <div class=\"survey-statement\">\n    <span *ngIf=\"choiceQuestion.attributes.required\" class=\"isRequired\">*</span>{{choiceQuestion.question}}\n  </div>\n  <p class=\"question-description\">\n    {{choiceQuestion.attributes.description}}\n  </p>\n\n</div>\n<div id=\"choice-question-delay\">\n\n  <ng-container *ngIf=\"isMultipleChoice; else singleSelection\">\n\n    <div *ngFor=\"let c of choiceQuestion.choices; index as choiceIndex\">\n      <label>\n        <input class=\"multiple-choice-checkbox\" type=\"checkbox\" name=\"option {{choiceIndex}}\"\n               (ngModelChange)=\"onOptionSelectionChange($event)\"\n               [disabled]=\"isDisabled(c)\"\n               [(ngModel)]=\"c.isChecked\"/>\n        <span class=\"btn-secondary multiple-choice\">{{c.text}}</span>\n      </label>\n    </div>\n\n\n    <div *ngIf=\"choiceQuestion.attributes.others && choiceQuestion.others != undefined\">\n      <label *ngIf=\"choiceQuestion.others.showCheckbox\">\n        <input type=\"checkbox\" name=\"Others\" style=\"display: none;\"\n               (click)=\"onClickOthers()\"\n               [(ngModel)]=\"choiceQuestion.others.isChecked\"/>\n        <span class=\"btn-secondary multiple-choice\">{{choiceQuestion.others.value}}</span>\n      </label>\n      <div *ngIf=\"!choiceQuestion.others.showCheckbox\">\n      <span class=\"btn-secondary multiple-choice\">\n            <input type=\"text\"\n                   appAutofocus\n                   [(ngModel)]=\"choiceQuestion.others.value\"\n                   class=\"multiple-choice-editableTextBox\">\n            <button (click)=\"onInputOthers()\"\n                    class=\"btn editable-others\">&#10004;</button>\n      </span>\n      </div>\n    </div>\n  </ng-container>\n\n  <ng-template #singleSelection>\n    <div\n      *ngFor=\"let c of choiceQuestion.choices; index as choiceIndex\">\n      <label>\n        <input class=\"multiple-choice-radio-btn\"\n               type=\"radio\"\n               name=\"radio_name\"\n               [id]=\"choiceIndex\"\n               [value]=\"c.identifier\"\n               (change)=\"onSingleSelect(c.identifier)\"\n               [checked]=\"c.isChecked\"\n        />\n        <span class=\"multiple-choice\">{{c.text}}</span>\n      </label>\n    </div>\n  </ng-template>\n\n  <button class=\"btn-primary\" id=\"btn-primary\" (click)=\"submit()\">{{isLastQuestion?'Submit': 'Done'}}</button>\n  <span *ngIf=\"!choiceQuestion.attributes.required\" (click)=\"submit()\"\n        class=\"skip-this-question skip-this-question-marginLeft\">Skip</span>\n</div>\n",
                    styles: [".multiple-choice-radio-btn{display:none}.editable-others{padding:0 4%;border:1px solid var(--white-25);margin:1.6% 1% 0 0}.editable-others:active,.editable-others:focus{border:1px solid var(--white-25)}.multiple-choice-editableTextBox{width:85%!important;height:28px!important;border:none!important;padding-left:2%!important;margin:0!important;font-size:inherit;color:var(--text-color-secondary)}.multiple-choice-editableTextBox:active,.multiple-choice-editableTextBox:focus{outline:0!important}.mcq-disabled{background:0 0;cursor:not-allowed}.mcq-subcategory{padding-left:15px}"]
                }] }
    ];
    /** @nocollapse */
    ChoiceComponent.ctorParameters = function () { return [
        { type: PagesService }
    ]; };
    ChoiceComponent.propDecorators = {
        choiceQuestion: [{ type: Input }],
        surveyResponse: [{ type: Input }],
        submitEvent: [{ type: Output }],
        isLastQuestion: [{ type: Input }],
        isMultipleChoice: [{ type: Input }]
    };
    return ChoiceComponent;
}());
export { ChoiceComponent };
if (false) {
    /** @type {?} */
    ChoiceComponent.prototype.isActive;
    /** @type {?} */
    ChoiceComponent.prototype.choiceQuestion;
    /** @type {?} */
    ChoiceComponent.prototype.surveyResponse;
    /** @type {?} */
    ChoiceComponent.prototype.submitEvent;
    /** @type {?} */
    ChoiceComponent.prototype.isLastQuestion;
    /**
     * @type {?}
     * @private
     */
    ChoiceComponent.prototype._isMultipleChoice;
    /**
     * @type {?}
     * @private
     */
    ChoiceComponent.prototype.pageService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hvaWNlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N1cnZleS1saWIvIiwic291cmNlcyI6WyJsaWIvcGFnZXMvcXVlc3Rpb25uYWlyZS9jaG9pY2UvY2hvaWNlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDN0UsT0FBTyxFQUFTLFFBQVEsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBQ25ELE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSw2QkFBNkIsQ0FBQztBQUM1RCxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sOENBQThDLENBQUM7QUFHMUU7SUFvQ0UseUJBQW9CLFdBQXlCO1FBQXpCLGdCQUFXLEdBQVgsV0FBVyxDQUFjO1FBN0I3QyxhQUFRLEdBQVUsS0FBSyxDQUFDO1FBUXhCLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztJQXdCakMsQ0FBQztJQWhCRCxzQkFBYSw2Q0FBZ0I7Ozs7UUFRN0I7WUFDRSxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztRQUNoQyxDQUFDOzs7OztRQVZELFVBQThCLEtBQWM7WUFDMUMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLEtBQUssQ0FBQztZQUMvQixPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFDdkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuQixJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxPQUFPOzs7O1lBQUMsVUFBQSxNQUFNLElBQUksT0FBQSxNQUFNLENBQUMsU0FBUyxHQUFHLEtBQUssRUFBeEIsQ0FBd0IsRUFBQyxDQUFDO1FBQzFFLENBQUM7OztPQUFBOzs7O0lBYUQsa0NBQVE7OztJQUFSO1FBQ0UsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FB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QUFBLEFBM0lELElBMklDO1NBdElZLGVBQWU7OztJQUUxQixtQ0FBd0I7O0lBQ3hCLHlDQUN5Qjs7SUFFekIseUNBQ2dDOztJQUVoQyxzQ0FDaUM7O0lBRWpDLHlDQUMrQjs7Ozs7SUFFL0IsNENBQW1DOzs7OztJQWdCdkIsc0NBQWlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Q2hvaWNlLCBRdWVzdGlvbn0gZnJvbSAnLi4vLi4vcGFnZXMubW9kZWwnO1xuaW1wb3J0IHtTdXJ2ZXlSZXNwb25zZXN9IGZyb20gJy4uLy4uL3N1cnZleS1yZXNwb25zZS5tb2RlbCc7XG5pbXBvcnQge1BhZ2VzU2VydmljZX0gZnJvbSAnLi4vLi4vLi4vc2hhcmVkL3BhZ2VzLXNlcnZpY2VzL3BhZ2VzLnNlcnZpY2UnO1xuXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2FwcC1jaG9pY2UnLFxuICB0ZW1wbGF0ZVVybDogJy4vY2hvaWNlLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vY2hvaWNlLmNvbXBvbmVudC5jc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBDaG9pY2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuXG4gIGlzQWN0aXZlOiBib29sZWFuPWZhbHNlO1xuICBASW5wdXQoKVxuICBjaG9pY2VRdWVzdGlvbjogUXVlc3Rpb247XG5cbiAgQElucHV0KClcbiAgc3VydmV5UmVzcG9uc2U6IFN1cnZleVJlc3BvbnNlcztcblxuICBAT3V0cHV0KClcbiAgc3VibWl0RXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgQElucHV0KClcbiAgcHVibGljIGlzTGFzdFF1ZXN0aW9uOiBib29sZWFuO1xuXG4gIHByaXZhdGUgX2lzTXVsdGlwbGVDaG9pY2U6IGJvb2xlYW47XG5cblxuICBASW5wdXQoKSBzZXQgaXNNdWx0aXBsZUNob2ljZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2lzTXVsdGlwbGVDaG9pY2UgPSB2YWx1ZTtcbiAgICBjb25zb2xlLmxvZygnSW5zaWRlIGlzTXVsdGlwbGVDaG9pY2UnKTtcbiAgICBjb25zb2xlLmxvZyh2YWx1ZSk7XG4gICAgdGhpcy5jaG9pY2VRdWVzdGlvbi5jaG9pY2VzLmZvckVhY2goY2hvaWNlID0+IGNob2ljZS5pc0NoZWNrZWQgPSBmYWxzZSk7XG4gIH1cblxuXG4gIGdldCBpc011bHRpcGxlQ2hvaWNlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9pc011bHRpcGxlQ2hvaWNlO1xuICB9XG5cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBhZ2VTZXJ2aWNlOiBQYWdlc1NlcnZpY2UpIHtcblxuXG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBjb25zb2xlLndhcm4odGhpcy5zdXJ2ZXlSZXNwb25zZSk7XG4gICAgaWYgKHRoaXMuc3VydmV5UmVzcG9uc2UuY2hvaWNlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnN1cnZleVJlc3BvbnNlLmNob2ljZXMuZm9yRWFjaChjaG9pY2UgPT4gY2hvaWNlLmlzQ2hlY2tlZCA9IHRydWUpO1xuICAgIH1cbiAgICBpZiAodGhpcy5wYWdlU2VydmljZS5zdGFnZSA9PSAnZW50cnktbmV4dCcpIHtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaG9pY2UtcXVlc3Rpb24nKS5jbGFzc05hbWUgPSAnZW50cnktbmV4dCc7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hvaWNlLXF1ZXN0aW9uLWRlbGF5JykuY2xhc3NOYW1lID0gJ2VudHJ5LW5leHQtZGVsYXknO1xuICAgIH1lbHNlIGlmICh0aGlzLnBhZ2VTZXJ2aWNlLnN0YWdlID09ICdlbnRyeS1wcmV2aW91cycpIHtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaG9pY2UtcXVlc3Rpb24nKS5jbGFzc05hbWUgPSAnZW50cnktcHJldmlvdXMtZGVsYXknO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nob2ljZS1xdWVzdGlvbi1kZWxheScpLmNsYXNzTmFtZSA9ICdlbnRyeS1wcmV2aW91cyc7XG4gICAgfVxuICB9XG5cbiAgc3VibWl0KCkge1xuICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMuc3VydmV5UmVzcG9uc2UuY2hvaWNlcyA9IHRoaXMuc2VsZWN0ZWRPcHRpb25zO1xuICAgIGlmICh0aGlzLnN1cnZleVJlc3BvbnNlLmNob2ljZXMgIT0gdW5kZWZpbmVkICYmXG4gICAgICB0aGlzLnN1cnZleVJlc3BvbnNlLmNob2ljZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5zdXJ2ZXlSZXNwb25zZS5xdWVzdGlvbklkID0gdGhpcy5jaG9pY2VRdWVzdGlvbi5xdWVzdGlvbklkO1xuICAgICAgdGhpcy5zdXJ2ZXlSZXNwb25zZS5xdWVzdGlvbiA9IHRoaXMuY2hvaWNlUXVlc3Rpb24ucXVlc3Rpb247XG4gICAgICB0aGlzLnN1cnZleVJlc3BvbnNlLnF1ZXN0aW9uVHlwZSA9IHRoaXMuY2hvaWNlUXVlc3Rpb24ucXVlc3Rpb25UeXBlO1xuICAgICAgdGhpcy5zdXJ2ZXlSZXNwb25zZS5pZGVudGlmaWVyID0gdGhpcy5jaG9pY2VRdWVzdGlvbi5pZGVudGlmaWVyO1xuICAgICAgdGhpcy5wYWdlU2VydmljZS5wZXJzaXN0U3VydmV5KHRoaXMuc3VydmV5UmVzcG9uc2UpO1xuICAgIH1cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuLXByaW1hcnknKS5jbGFzc0xpc3QuYWRkKCdibGluay1idG4tYW5pbWF0aW9uJyk7XG4gICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgdGhpcy5zdWJtaXRFdmVudC5lbWl0KCk7XG4gICAgfSwgMzUwKTtcbiAgfVxuXG4gIGdldCBzZWxlY3RlZE9wdGlvbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hvaWNlUXVlc3Rpb24uY2hvaWNlc1xuICAgICAgLmZpbHRlcihjaG9pY2UgPT4gY2hvaWNlLmlzQ2hlY2tlZClcbiAgICAgIC5tYXAob3B0ID0+IG9wdCk7XG4gIH1cblxuXG4gIHByaXZhdGUgY2hhbmdlU2VsZWN0aW9uKGNob2ljZXM6IENob2ljZVtdKSB7XG4gICAgaWYgKHR5cGVvZiBjaG9pY2VzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgY2hvaWNlcy5mb3JFYWNoKGNob2ljZSA9PiB7XG4gICAgICAgIHRoaXMuY2hvaWNlUXVlc3Rpb24uY2hvaWNlcy5mb3JFYWNoKGMgPT57XG4gICAgICAgICAgaWYgKGNob2ljZS5jaG9pY2VJZCA9PSBjLmNob2ljZUlkKXtcbiAgICAgICAgICAgIGMuaXNDaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cblxuICBvbkNsaWNrT3RoZXJzKCkge1xuXG4gICAgaWYgKCF0aGlzLmNob2ljZVF1ZXN0aW9uLm90aGVycy5pc0NoZWNrZWQpIHtcbiAgICAgIHRoaXMuY2hvaWNlUXVlc3Rpb24ub3RoZXJzLmlzQ2hlY2tlZCA9IHRydWU7XG4gICAgICB0aGlzLmNob2ljZVF1ZXN0aW9uLm90aGVycy5zaG93Q2hlY2tib3ggPSBmYWxzZTtcbiAgICB9ZWxzZSB7XG4gICAgICB0aGlzLmNob2ljZVF1ZXN0aW9uLm90aGVycy5pc0NoZWNrZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuY2hvaWNlUXVlc3Rpb24ub3RoZXJzLnNob3dDaGVja2JveCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgb25JbnB1dE90aGVycygpIHtcbiAgICB0aGlzLmNob2ljZVF1ZXN0aW9uLm90aGVycy5pc0NoZWNrZWQgPSB0cnVlO1xuICAgIHRoaXMuY2hvaWNlUXVlc3Rpb24ub3RoZXJzLnNob3dDaGVja2JveCA9IHRydWU7XG5cbiAgfVxuXG4gIG9uT3B0aW9uU2VsZWN0aW9uQ2hhbmdlKCRldmVudCkge1xuICAgIGlmICgkZXZlbnQpIHtcbiAgICAgIHRoaXMuY2hvaWNlUXVlc3Rpb24uYXR0cmlidXRlcy5udW1iZXJPZlNlbGVjdGlvbisrO1xuICAgIH1lbHNlIHtcbiAgICAgIHRoaXMuY2hvaWNlUXVlc3Rpb24uYXR0cmlidXRlcy5udW1iZXJPZlNlbGVjdGlvbi0tO1xuICAgIH1cbiAgfVxuXG4gIG9uU2luZ2xlU2VsZWN0KGlkZW50aWZpZXI6IHN0cmluZykge1xuICAgIHRoaXMuY2hvaWNlUXVlc3Rpb24uY2hvaWNlcy5mb3JFYWNoKGNob2ljZSA9PiBjaG9pY2UuaXNDaGVja2VkID0gZmFsc2UpO1xuICAgIGxldCBpbmRleCA9IHRoaXMuY2hvaWNlUXVlc3Rpb24uY2hvaWNlcy5maW5kSW5kZXgoY2hvaWNlID0+IGNob2ljZS5pZGVudGlmaWVyID09IGlkZW50aWZpZXIpO1xuICAgIGlmIChpbmRleCA+IDApe1xuICAgICAgdGhpcy5jaG9pY2VRdWVzdGlvbi5jaG9pY2VzW2luZGV4XS5pc0NoZWNrZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gICBpc0Rpc2FibGVkKGNob2ljZTogQ2hvaWNlKXtcblxuICAgICBpZiAodGhpcy5jaG9pY2VRdWVzdGlvbi5hdHRyaWJ1dGVzLnNlbGVjdGlvbiA9PSB1bmRlZmluZWQpXG4gICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgIGVsc2UgaWYgKHRoaXMuY2hvaWNlUXVlc3Rpb24uYXR0cmlidXRlcy5zZWxlY3Rpb24udHlwZSA9PSAnRXhhY3QnKXtcbiAgICAgIHJldHVybiB0aGlzLmNob2ljZVF1ZXN0aW9uLmF0dHJpYnV0ZXMubnVtYmVyT2ZTZWxlY3Rpb24gPj0gdGhpcy5jaG9pY2VRdWVzdGlvbi5hdHRyaWJ1dGVzLnNlbGVjdGlvbi5leGFjdFxuICAgICAgICAmJiAhY2hvaWNlLmlzQ2hlY2tlZDtcblxuICAgIH1lbHNlIGlmICh0aGlzLmNob2ljZVF1ZXN0aW9uLmF0dHJpYnV0ZXMuc2VsZWN0aW9uLnR5cGUgPT0gJ1JhbmdlJykge1xuICAgICAgcmV0dXJuIHRoaXMuY2hvaWNlUXVlc3Rpb24uYXR0cmlidXRlcy5udW1iZXJPZlNlbGVjdGlvbiA+PSB0aGlzLmNob2ljZVF1ZXN0aW9uLmF0dHJpYnV0ZXMuc2VsZWN0aW9uLnJhbmdlVG9cbiAgICAgICAgJiYgIWNob2ljZS5pc0NoZWNrZWQ7XG4gICAgfSBlbHNlIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIl19