/**
 * @fileoverview added by tsickle
 * Generated from: lib/pages/questionnaire/expression-builder.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
var ExpressionBuilder = /** @class */ (function () {
    function ExpressionBuilder() {
        this.IS_EQUALS_TO = 'Is equals to';
        this.IS_NOT_EQUALS_TO = 'Is not equals to';
        this.IS_LESS_THAN = 'Is less than';
        this.IS_GREATER_THAN = 'Is greater than';
        this.IS_LESS_THAN_OR_EQUALS_TO = 'Is less than or equals to';
        this.IS_GREATER_THAN_OR_EQUALS_TO = 'Is grater than or equals to';
        this.IS = 'Is';
        this.IS_NOT = 'Is not';
        this.IS_ON = "Is on";
        this.IS_NOT_ON = "Is not on";
        this.IS_BEFORE = "Is before";
        this.IS_AFTER = "Is after";
        this.IS_BEFORE_OR_ON = "Is before or on";
        this.IS_AFTER_OR_ON = "Is after or on";
        this.IS_BETWEEN = "Is between";
        this.IS_BEGINS_WITH = "Is begins with";
        this.IS_ENDS_WITH = "Is ends with";
        this.CONTAINS = "Contains";
        this.DOES_NOT_CONTAINS = "Does not contains";
    }
    /**
     * @param {?} conditions
     * @param {?} responses
     * @param {?} questionType
     * @return {?}
     */
    ExpressionBuilder.prototype.build = /**
     * @param {?} conditions
     * @param {?} responses
     * @param {?} questionType
     * @return {?}
     */
    function (conditions, responses, questionType) {
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d;
        /** @type {?} */
        var expression = '';
        switch (questionType) {
            case 'Drop down':
            case 'Choice':
                var _loop_1 = function (condition) {
                    /** @type {?} */
                    var result = this_1.evaluateChoiceConditions(condition, responses[responses.findIndex((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) { return res.questionId == condition._if; }))]);
                    if (condition.relationWithNextCondition != undefined)
                        expression += result + ' ' + condition.relationWithNextCondition + ' ';
                    else
                        expression += result + ' ';
                };
                var this_1 = this;
                try {
                    for (var conditions_1 = tslib_1.__values(conditions), conditions_1_1 = conditions_1.next(); !conditions_1_1.done; conditions_1_1 = conditions_1.next()) {
                        var condition = conditions_1_1.value;
                        _loop_1(condition);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (conditions_1_1 && !conditions_1_1.done && (_a = conditions_1.return)) _a.call(conditions_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                break;
            case 'Yes No':
                var _loop_2 = function (condition) {
                    /** @type {?} */
                    var result = this_2.evaluateYesNoConditions(condition, responses[responses.findIndex((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) { return res.questionId == condition._if; }))]);
                    if (condition.relationWithNextCondition != undefined)
                        expression += result + ' ' + condition.relationWithNextCondition + ' ';
                    else
                        expression += result + ' ';
                };
                var this_2 = this;
                try {
                    for (var conditions_2 = tslib_1.__values(conditions), conditions_2_1 = conditions_2.next(); !conditions_2_1.done; conditions_2_1 = conditions_2.next()) {
                        var condition = conditions_2_1.value;
                        _loop_2(condition);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (conditions_2_1 && !conditions_2_1.done && (_b = conditions_2.return)) _b.call(conditions_2);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                break;
            case 'Rating':
                var _loop_3 = function (i) {
                    /** @type {?} */
                    var result = this_3.evaluateRatingConditions(conditions[i], responses[responses.findIndex((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) { return res.questionId == conditions[i]._if; }))]);
                    console.warn(result);
                    if ((i + 1) < conditions.length) {
                        expression += result + ' ' + conditions[i].relationWithNextCondition + ' ';
                    }
                    else {
                        expression += result + ' ';
                    }
                };
                var this_3 = this;
                for (var i = 0; i < conditions.length; i++) {
                    _loop_3(i);
                }
                break;
            case 'Nps':
                var _loop_4 = function (i) {
                    /** @type {?} */
                    var result = this_4.evaluateNPSConditions(conditions[i], responses[responses.findIndex((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) { return res.questionId == conditions[i]._if; }))]);
                    console.warn(result);
                    if ((i + 1) < conditions.length) {
                        expression += result + ' ' + conditions[i].relationWithNextCondition + ' ';
                    }
                    else {
                        expression += result + ' ';
                    }
                };
                var this_4 = this;
                for (var i = 0; i < conditions.length; i++) {
                    _loop_4(i);
                }
                break;
            case 'Date':
                var _loop_5 = function (condition) {
                    /** @type {?} */
                    var result = this_5.evaluateDateConditions(condition, responses[responses.findIndex((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) { return res.questionId == condition._if; }))]);
                    if (condition.relationWithNextCondition != undefined) {
                        expression += result + ' ' + condition.relationWithNextCondition + ' ';
                    }
                    else {
                        expression += result + ' ';
                    }
                };
                var this_5 = this;
                try {
                    for (var conditions_3 = tslib_1.__values(conditions), conditions_3_1 = conditions_3.next(); !conditions_3_1.done; conditions_3_1 = conditions_3.next()) {
                        var condition = conditions_3_1.value;
                        _loop_5(condition);
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (conditions_3_1 && !conditions_3_1.done && (_c = conditions_3.return)) _c.call(conditions_3);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
                break;
            case 'Short text':
                var _loop_6 = function (condition) {
                    /** @type {?} */
                    var result = this_6.evaluateTextConditions(condition, responses[responses.findIndex((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) { return res.questionId == condition._if; }))]);
                    if (condition.relationWithNextCondition != undefined) {
                        expression += result + ' ' + condition.relationWithNextCondition + ' ';
                    }
                    else {
                        expression += result + ' ';
                    }
                };
                var this_6 = this;
                try {
                    for (var conditions_4 = tslib_1.__values(conditions), conditions_4_1 = conditions_4.next(); !conditions_4_1.done; conditions_4_1 = conditions_4.next()) {
                        var condition = conditions_4_1.value;
                        _loop_6(condition);
                    }
                }
                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                finally {
                    try {
                        if (conditions_4_1 && !conditions_4_1.done && (_d = conditions_4.return)) _d.call(conditions_4);
                    }
                    finally { if (e_4) throw e_4.error; }
                }
                break;
            default:
                break;
        }
        return expression;
    };
    /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    ExpressionBuilder.prototype.evaluateChoiceConditions = /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    function (condition, currentResponse) {
        return condition.condition == this.IS ?
            currentResponse.choices.some((/**
             * @param {?} choice
             * @return {?}
             */
            function (choice) { return choice.choiceId == condition._this; })) :
            !currentResponse.choices.some((/**
             * @param {?} choice
             * @return {?}
             */
            function (choice) { return choice.choiceId == condition._this; }));
    };
    /**
     * @private
     * @param {?} condition
     * @param {?} response
     * @return {?}
     */
    ExpressionBuilder.prototype.evaluateRatingConditions = /**
     * @private
     * @param {?} condition
     * @param {?} response
     * @return {?}
     */
    function (condition, response) {
        console.warn(response);
        switch (condition.condition) {
            case this.IS_EQUALS_TO:
                return (response.rating == condition._this);
            case this.IS_NOT_EQUALS_TO:
                return (response.rating != condition._this);
            case this.IS_LESS_THAN:
                return (response.rating < condition._this);
            case this.IS_GREATER_THAN:
                return (response.rating > condition._this);
            case this.IS_LESS_THAN_OR_EQUALS_TO:
                return (response.rating <= condition._this);
            case this.IS_GREATER_THAN_OR_EQUALS_TO:
                return (response.rating >= condition._this);
            default:
                return false;
        }
    };
    /**
     * @private
     * @param {?} condition
     * @param {?} response
     * @return {?}
     */
    ExpressionBuilder.prototype.evaluateNPSConditions = /**
     * @private
     * @param {?} condition
     * @param {?} response
     * @return {?}
     */
    function (condition, response) {
        console.warn(response);
        switch (condition.condition) {
            case this.IS:
                return RegExp(condition._this).test(response.rating + '');
            case this.IS_NOT:
                return !RegExp(condition._this).test(response.rating + '');
            default:
                return false;
        }
    };
    /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    ExpressionBuilder.prototype.evaluateYesNoConditions = /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    function (condition, currentResponse) {
        return condition.condition == this.IS ?
            currentResponse.answer == condition._this :
            !currentResponse.answer == condition._this;
    };
    /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    ExpressionBuilder.prototype.evaluateDateConditions = /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    function (condition, currentResponse) {
        /** @type {?} */
        var thisDate = new Date(condition._this);
        /** @type {?} */
        var responseDate = new Date(currentResponse.answer);
        switch (condition.condition) {
            case this.IS_ON:
                return responseDate == thisDate;
            case this.IS_NOT_ON:
                return responseDate != thisDate;
            case this.IS_BEFORE:
                return responseDate < thisDate;
            case this.IS_AFTER:
                return responseDate > thisDate;
            case this.IS_BEFORE_OR_ON:
                return responseDate <= thisDate;
            case this.IS_AFTER_OR_ON:
                return responseDate >= thisDate;
            //todo Expression for date between range.
            case this.IS_BETWEEN:
                return true;
            default:
                return false;
        }
    };
    /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    ExpressionBuilder.prototype.evaluateTextConditions = /**
     * @private
     * @param {?} condition
     * @param {?} currentResponse
     * @return {?}
     */
    function (condition, currentResponse) {
        switch (condition.condition) {
            case this.IS_EQUALS_TO:
                return currentResponse.answer == condition._this;
            case this.IS_BEGINS_WITH:
                return currentResponse.answer.startsWith(condition._this);
            case this.IS_ENDS_WITH:
                return currentResponse.answer.endsWith(condition._this);
            case this.CONTAINS:
                return currentResponse.answer.includes(condition._this);
            case this.DOES_NOT_CONTAINS:
                return !currentResponse.answer.includes(condition._this);
            default:
                return false;
        }
    };
    return ExpressionBuilder;
}());
export { ExpressionBuilder };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_EQUALS_TO;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_NOT_EQUALS_TO;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_LESS_THAN;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_GREATER_THAN;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_LESS_THAN_OR_EQUALS_TO;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_GREATER_THAN_OR_EQUALS_TO;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_NOT;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_ON;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_NOT_ON;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_BEFORE;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_AFTER;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_BEFORE_OR_ON;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_AFTER_OR_ON;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_BETWEEN;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_BEGINS_WITH;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.IS_ENDS_WITH;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.CONTAINS;
    /**
     * @type {?}
     * @private
     */
    ExpressionBuilder.prototype.DOES_NOT_CONTAINS;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwcmVzc2lvbi1idWlsZGVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vc3VydmV5LWxpYi8iLCJzb3VyY2VzIjpbImxpYi9wYWdlcy9xdWVzdGlvbm5haXJlL2V4cHJlc3Npb24tYnVpbGRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFHQTtJQUFBO1FBRXFCLGlCQUFZLEdBQVcsY0FBYyxDQUFDO1FBQ3RDLHFCQUFnQixHQUFXLGtCQUFrQixDQUFDO1FBQzlDLGlCQUFZLEdBQVcsY0FBYyxDQUFDO1FBQ3RDLG9CQUFlLEdBQVcsaUJBQWlCLENBQUM7UUFDNUMsOEJBQXlCLEdBQVcsMkJBQTJCLENBQUM7UUFDaEUsaUNBQTRCLEdBQVcsNkJBQTZCLENBQUM7UUFDckUsT0FBRSxHQUFXLElBQUksQ0FBQztRQUNsQixXQUFNLEdBQVcsUUFBUSxDQUFDO1FBQzFCLFVBQUssR0FBVyxPQUFPLENBQUM7UUFDeEIsY0FBUyxHQUFXLFdBQVcsQ0FBQztRQUNoQyxjQUFTLEdBQVcsV0FBVyxDQUFDO1FBQ2hDLGFBQVEsR0FBVyxVQUFVLENBQUM7UUFDOUIsb0JBQWUsR0FBVyxpQkFBaUIsQ0FBQztRQUM1QyxtQkFBYyxHQUFXLGdCQUFnQixDQUFDO1FBQzFDLGVBQVUsR0FBVyxZQUFZLENBQUM7UUFDbEMsbUJBQWMsR0FBVyxnQkFBZ0IsQ0FBQztRQUMxQyxpQkFBWSxHQUFXLGNBQWMsQ0FBQztRQUN0QyxhQUFRLEdBQVcsVUFBVSxDQUFDO1FBQzlCLHNCQUFpQixHQUFXLG1CQUFtQixDQUFDO0lBbU1yRSxDQUFDOzs7Ozs7O0lBak1RLGlDQUFLOzs7Ozs7SUFBWixVQUFhLFVBQXVCLEVBQ2hCLFNBQTRCLEVBQzVCLFlBQW9COzs7WUFFbEMsVUFBVSxHQUFXLEVBQUU7UUFFM0IsUUFBUSxZQUFZLEVBQUU7WUFDcEIsS0FBSyxXQUFXLENBQUM7WUFDakIsS0FBSyxRQUFRO3dDQUNGLFNBQVM7O3dCQUNaLE1BQU0sR0FBRyxPQUFLLHdCQUF3QixDQUFD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IGZyb20gJy4uL3BhZ2VzLm1vZGVsJztcbmltcG9ydCB7U3VydmV5UmVzcG9uc2VzfSBmcm9tICcuLi9zdXJ2ZXktcmVzcG9uc2UubW9kZWwnO1xuXG5leHBvcnQgY2xhc3MgRXhwcmVzc2lvbkJ1aWxkZXIge1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSBJU19FUVVBTFNfVE86IHN0cmluZyA9ICdJcyBlcXVhbHMgdG8nO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgSVNfTk9UX0VRVUFMU19UTzogc3RyaW5nID0gJ0lzIG5vdCBlcXVhbHMgdG8nO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgSVNfTEVTU19USEFOOiBzdHJpbmcgPSAnSXMgbGVzcyB0aGFuJztcbiAgICBwcml2YXRlIHJlYWRvbmx5IElTX0dSRUFURVJfVEhBTjogc3RyaW5nID0gJ0lzIGdyZWF0ZXIgdGhhbic7XG4gICAgcHJpdmF0ZSByZWFkb25seSBJU19MRVNTX1RIQU5fT1JfRVFVQUxTX1RPOiBzdHJpbmcgPSAnSXMgbGVzcyB0aGFuIG9yIGVxdWFscyB0byc7XG4gICAgcHJpdmF0ZSByZWFkb25seSBJU19HUkVBVEVSX1RIQU5fT1JfRVFVQUxTX1RPOiBzdHJpbmcgPSAnSXMgZ3JhdGVyIHRoYW4gb3IgZXF1YWxzIHRvJztcbiAgICBwcml2YXRlIHJlYWRvbmx5IElTOiBzdHJpbmcgPSAnSXMnO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgSVNfTk9UOiBzdHJpbmcgPSAnSXMgbm90JztcbiAgICBwcml2YXRlIHJlYWRvbmx5IElTX09OOiBzdHJpbmcgPSBcIklzIG9uXCI7XG4gICAgcHJpdmF0ZSByZWFkb25seSBJU19OT1RfT046IHN0cmluZyA9IFwiSXMgbm90IG9uXCI7XG4gICAgcHJpdmF0ZSByZWFkb25seSBJU19CRUZPUkU6IHN0cmluZyA9IFwiSXMgYmVmb3JlXCI7XG4gICAgcHJpdmF0ZSByZWFkb25seSBJU19BRlRFUjogc3RyaW5nID0gXCJJcyBhZnRlclwiO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgSVNfQkVGT1JFX09SX09OOiBzdHJpbmcgPSBcIklzIGJlZm9yZSBvciBvblwiO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgSVNfQUZURVJfT1JfT046IHN0cmluZyA9IFwiSXMgYWZ0ZXIgb3Igb25cIjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IElTX0JFVFdFRU46IHN0cmluZyA9IFwiSXMgYmV0d2VlblwiO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgSVNfQkVHSU5TX1dJVEg6IHN0cmluZyA9IFwiSXMgYmVnaW5zIHdpdGhcIjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IElTX0VORFNfV0lUSDogc3RyaW5nID0gXCJJcyBlbmRzIHdpdGhcIjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IENPTlRBSU5TOiBzdHJpbmcgPSBcIkNvbnRhaW5zXCI7XG4gICAgcHJpdmF0ZSByZWFkb25seSBET0VTX05PVF9DT05UQUlOUzogc3RyaW5nID0gXCJEb2VzIG5vdCBjb250YWluc1wiO1xuXG4gIHB1YmxpYyBidWlsZChjb25kaXRpb25zOiBDb25kaXRpb25bXSxcbiAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZXM6IFN1cnZleVJlc3BvbnNlc1tdLFxuICAgICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uVHlwZTogc3RyaW5nKTogc3RyaW5ne1xuXG4gICAgbGV0IGV4cHJlc3Npb246IHN0cmluZyA9ICcnO1xuXG4gICAgc3dpdGNoIChxdWVzdGlvblR5cGUpIHtcbiAgICAgIGNhc2UgJ0Ryb3AgZG93bic6XG4gICAgICBjYXNlICdDaG9pY2UnOlxuICAgICAgICBmb3IgKGxldCBjb25kaXRpb24gb2YgY29uZGl0aW9ucykge1xuICAgICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmV2YWx1YXRlQ2hvaWNlQ29uZGl0aW9ucyhjb25kaXRpb24sIHJlc3BvbnNlc1tyZXNwb25zZXMuZmluZEluZGV4KHJlcyA9PiByZXMucXVlc3Rpb25JZCA9PSBjb25kaXRpb24uX2lmKV0pO1xuICAgICAgICAgIGlmIChjb25kaXRpb24ucmVsYXRpb25XaXRoTmV4dENvbmRpdGlvbiAhPSB1bmRlZmluZWQpXG4gICAgICAgICAgZXhwcmVzc2lvbiArPSByZXN1bHQgKyAnICcrIGNvbmRpdGlvbi5yZWxhdGlvbldpdGhOZXh0Q29uZGl0aW9uICsgJyAnO1xuICAgICAgICAgIGVsc2UgIGV4cHJlc3Npb24gKz0gcmVzdWx0ICsgJyAnO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdZZXMgTm8nOlxuICAgICAgICBmb3IgKGxldCBjb25kaXRpb24gb2YgY29uZGl0aW9ucykge1xuICAgICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmV2YWx1YXRlWWVzTm9Db25kaXRpb25zKGNvbmRpdGlvbixyZXNwb25zZXNbcmVzcG9uc2VzLmZpbmRJbmRleChyZXMgPT4gcmVzLnF1ZXN0aW9uSWQgPT0gY29uZGl0aW9uLl9pZildKTtcbiAgICAgICAgICBpZiAoY29uZGl0aW9uLnJlbGF0aW9uV2l0aE5leHRDb25kaXRpb24gIT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgZXhwcmVzc2lvbiArPSByZXN1bHQgKyAnICcrIGNvbmRpdGlvbi5yZWxhdGlvbldpdGhOZXh0Q29uZGl0aW9uICsgJyAnO1xuICAgICAgICAgIGVsc2UgIGV4cHJlc3Npb24gKz0gcmVzdWx0ICsgJyAnO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdSYXRpbmcnOlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbmRpdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5ldmFsdWF0ZVJhdGluZ0NvbmRpdGlvbnMoY29uZGl0aW9uc1tpXSxyZXNwb25zZXNbcmVzcG9uc2VzLmZpbmRJbmRleChyZXMgPT4gcmVzLnF1ZXN0aW9uSWQgPT0gY29uZGl0aW9uc1tpXS5faWYpXSk7XG4gICAgICAgICAgY29uc29sZS53YXJuKHJlc3VsdCk7XG4gICAgICAgICAgaWYgKChpICsgMSkgPCBjb25kaXRpb25zLmxlbmd0aCl7XG4gICAgICAgICAgICBleHByZXNzaW9uICs9IHJlc3VsdCArICcgJyArIGNvbmRpdGlvbnNbaV0ucmVsYXRpb25XaXRoTmV4dENvbmRpdGlvbisgJyAnO1xuXG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBleHByZXNzaW9uICs9IHJlc3VsdCArICcgJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdOcHMnOlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbmRpdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5ldmFsdWF0ZU5QU0NvbmRpdGlvbnMoY29uZGl0aW9uc1tpXSxyZXNwb25zZXNbcmVzcG9uc2VzLmZpbmRJbmRleChyZXMgPT4gcmVzLnF1ZXN0aW9uSWQgPT0gY29uZGl0aW9uc1tpXS5faWYpXSk7XG4gICAgICAgICAgY29uc29sZS53YXJuKHJlc3VsdCk7XG4gICAgICAgICAgaWYgKChpICsgMSkgPCBjb25kaXRpb25zLmxlbmd0aCl7XG4gICAgICAgICAgICBleHByZXNzaW9uICs9IHJlc3VsdCArICcgJyArIGNvbmRpdGlvbnNbaV0ucmVsYXRpb25XaXRoTmV4dENvbmRpdGlvbisgJyAnO1xuXG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBleHByZXNzaW9uICs9IHJlc3VsdCArICcgJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdEYXRlJzpcbiAgICAgICAgZm9yIChsZXQgY29uZGl0aW9uIG9mIGNvbmRpdGlvbnMpIHtcbiAgICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5ldmFsdWF0ZURhdGVDb25kaXRpb25zKGNvbmRpdGlvbixyZXNwb25zZXNbcmVzcG9uc2VzLmZpbmRJbmRleChyZXMgPT4gcmVzLnF1ZXN0aW9uSWQgPT0gY29uZGl0aW9uLl9pZildKTtcbiAgICAgICAgICBpZiAoY29uZGl0aW9uLnJlbGF0aW9uV2l0aE5leHRDb25kaXRpb24gIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgIGV4cHJlc3Npb24gKz0gcmVzdWx0ICsgJyAnICsgY29uZGl0aW9uLnJlbGF0aW9uV2l0aE5leHRDb25kaXRpb24rICcgJztcbiAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIGV4cHJlc3Npb24gKz0gcmVzdWx0ICsgJyAnO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnU2hvcnQgdGV4dCc6XG4gICAgICAgIGZvciAobGV0IGNvbmRpdGlvbiBvZiBjb25kaXRpb25zKSB7XG4gICAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMuZXZhbHVhdGVUZXh0Q29uZGl0aW9ucyhjb25kaXRpb24scmVzcG9uc2VzW3Jlc3BvbnNlcy5maW5kSW5kZXgocmVzID0+IHJlcy5xdWVzdGlvbklkID09IGNvbmRpdGlvbi5faWYpXSk7XG4gICAgICAgICAgaWYgKGNvbmRpdGlvbi5yZWxhdGlvbldpdGhOZXh0Q29uZGl0aW9uICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICBleHByZXNzaW9uICs9IHJlc3VsdCArICcgJyArIGNvbmRpdGlvbi5yZWxhdGlvbldpdGhOZXh0Q29uZGl0aW9uKyAnICc7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBleHByZXNzaW9uICs9IHJlc3VsdCArICcgJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiBleHByZXNzaW9uO1xuICB9XG5cblxuXG4gIHByaXZhdGUgZXZhbHVhdGVDaG9pY2VDb25kaXRpb25zKGNvbmRpdGlvbjogQ29uZGl0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmVzcG9uc2U6IFN1cnZleVJlc3BvbnNlcyl7XG4gICAgcmV0dXJuIGNvbmRpdGlvbi5jb25kaXRpb24gPT0gdGhpcy5JUyA/XG4gICAgICBjdXJyZW50UmVzcG9uc2UuY2hvaWNlcy5zb21lKGNob2ljZSA9PiBjaG9pY2UuY2hvaWNlSWQgPT0gY29uZGl0aW9uLl90aGlzKSA6XG4gICAgICAhY3VycmVudFJlc3BvbnNlLmNob2ljZXMuc29tZShjaG9pY2UgPT4gY2hvaWNlLmNob2ljZUlkID09IGNvbmRpdGlvbi5fdGhpcyk7XG4gIH1cblxuXG4gIHByaXZhdGUgZXZhbHVhdGVSYXRpbmdDb25kaXRpb25zKGNvbmRpdGlvbjogQ29uZGl0aW9uLCByZXNwb25zZTogU3VydmV5UmVzcG9uc2VzKSB7XG4gICAgY29uc29sZS53YXJuKHJlc3BvbnNlKTtcbiAgICBzd2l0Y2ggKGNvbmRpdGlvbi5jb25kaXRpb24pIHtcbiAgICAgIGNhc2UgdGhpcy5JU19FUVVBTFNfVE86XG4gICAgICAgIHJldHVybiAocmVzcG9uc2UucmF0aW5nID09IGNvbmRpdGlvbi5fdGhpcyk7XG4gICAgICBjYXNlIHRoaXMuSVNfTk9UX0VRVUFMU19UTzpcbiAgICAgICAgcmV0dXJuIChyZXNwb25zZS5yYXRpbmcgIT0gY29uZGl0aW9uLl90aGlzKTtcbiAgICAgIGNhc2UgdGhpcy5JU19MRVNTX1RIQU46XG4gICAgICAgIHJldHVybiAocmVzcG9uc2UucmF0aW5nIDwgY29uZGl0aW9uLl90aGlzKTtcbiAgICAgIGNhc2UgdGhpcy5JU19HUkVBVEVSX1RIQU46XG4gICAgICAgIHJldHVybiAocmVzcG9uc2UucmF0aW5nID4gY29uZGl0aW9uLl90aGlzKTtcbiAgICAgIGNhc2UgdGhpcy5JU19MRVNTX1RIQU5fT1JfRVFVQUxTX1RPOlxuICAgICAgICByZXR1cm4gKHJlc3BvbnNlLnJhdGluZyA8PSBjb25kaXRpb24uX3RoaXMpO1xuICAgICAgY2FzZSB0aGlzLklTX0dSRUFURVJfVEhBTl9PUl9FUVVBTFNfVE86XG4gICAgICAgIHJldHVybiAocmVzcG9uc2UucmF0aW5nID49IGNvbmRpdGlvbi5fdGhpcyk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cblxuICBwcml2YXRlIGV2YWx1YXRlTlBTQ29uZGl0aW9ucyhjb25kaXRpb246IENvbmRpdGlvbiwgcmVzcG9uc2U6IFN1cnZleVJlc3BvbnNlcykge1xuICAgIGNvbnNvbGUud2FybihyZXNwb25zZSk7XG4gICAgc3dpdGNoIChjb25kaXRpb24uY29uZGl0aW9uKSB7XG4gICAgICBjYXNlIHRoaXMuSVM6XG4gICAgICAgIHJldHVybiBSZWdFeHAoY29uZGl0aW9uLl90aGlzKS50ZXN0KHJlc3BvbnNlLnJhdGluZysnJyk7XG4gICAgICBjYXNlIHRoaXMuSVNfTk9UOlxuICAgICAgICByZXR1cm4gIVJlZ0V4cChjb25kaXRpb24uX3RoaXMpLnRlc3QocmVzcG9uc2UucmF0aW5nKycnKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGV2YWx1YXRlWWVzTm9Db25kaXRpb25zKGNvbmRpdGlvbjogQ29uZGl0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSZXNwb25zZTogU3VydmV5UmVzcG9uc2VzKSB7XG4gICAgcmV0dXJuIGNvbmRpdGlvbi5jb25kaXRpb24gPT0gdGhpcy5JUyA/XG4gICAgICBjdXJyZW50UmVzcG9uc2UuYW5zd2VyID09IGNvbmRpdGlvbi5fdGhpcyA6XG4gICAgICAhY3VycmVudFJlc3BvbnNlLmFuc3dlciA9PSBjb25kaXRpb24uX3RoaXM7XG4gIH1cblxuICBwcml2YXRlIGV2YWx1YXRlRGF0ZUNvbmRpdGlvbnMoY29uZGl0aW9uOiBDb25kaXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmVzcG9uc2U6IFN1cnZleVJlc3BvbnNlcykge1xuXG4gICAgbGV0IHRoaXNEYXRlID0gbmV3IERhdGUoY29uZGl0aW9uLl90aGlzKTtcbiAgICBsZXQgcmVzcG9uc2VEYXRlID0gbmV3IERhdGUoY3VycmVudFJlc3BvbnNlLmFuc3dlcik7XG5cbiAgICBzd2l0Y2ggKGNvbmRpdGlvbi5jb25kaXRpb24pe1xuXG4gICAgICBjYXNlIHRoaXMuSVNfT046XG4gICAgICAgIHJldHVybiByZXNwb25zZURhdGUgPT0gdGhpc0RhdGU7XG5cbiAgICAgIGNhc2UgdGhpcy5JU19OT1RfT046XG4gICAgICAgIHJldHVybiByZXNwb25zZURhdGUgIT0gdGhpc0RhdGU7XG5cbiAgICAgIGNhc2UgdGhpcy5JU19CRUZPUkU6XG4gICAgICAgIHJldHVybiByZXNwb25zZURhdGUgPCB0aGlzRGF0ZTtcblxuICAgICAgY2FzZSB0aGlzLklTX0FGVEVSOlxuICAgICAgICByZXR1cm4gcmVzcG9uc2VEYXRlID4gdGhpc0RhdGU7XG5cbiAgICAgIGNhc2UgdGhpcy5JU19CRUZPUkVfT1JfT046XG4gICAgICAgIHJldHVybiByZXNwb25zZURhdGUgPD0gdGhpc0RhdGU7XG5cbiAgICAgIGNhc2UgdGhpcy5JU19BRlRFUl9PUl9PTjpcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlRGF0ZSA+PSB0aGlzRGF0ZTtcblxuICAgICAgICAvL3RvZG8gRXhwcmVzc2lvbiBmb3IgZGF0ZSBiZXR3ZWVuIHJhbmdlLlxuICAgICAgY2FzZSB0aGlzLklTX0JFVFdFRU46XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXZhbHVhdGVUZXh0Q29uZGl0aW9ucyhjb25kaXRpb246IENvbmRpdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSZXNwb25zZTogU3VydmV5UmVzcG9uc2VzKSB7XG4gICAgICAgIHN3aXRjaChjb25kaXRpb24uY29uZGl0aW9uKXtcblxuICAgICAgICAgIGNhc2UgdGhpcy5JU19FUVVBTFNfVE86XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudFJlc3BvbnNlLmFuc3dlciA9PSBjb25kaXRpb24uX3RoaXM7XG5cbiAgICAgICAgICBjYXNlIHRoaXMuSVNfQkVHSU5TX1dJVEg6XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudFJlc3BvbnNlLmFuc3dlci5zdGFydHNXaXRoKGNvbmRpdGlvbi5fdGhpcyk7XG5cbiAgICAgICAgICBjYXNlIHRoaXMuSVNfRU5EU19XSVRIOlxuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRSZXNwb25zZS5hbnN3ZXIuZW5kc1dpdGgoY29uZGl0aW9uLl90aGlzKTtcblxuICAgICAgICAgIGNhc2UgdGhpcy5DT05UQUlOUzpcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50UmVzcG9uc2UuYW5zd2VyLmluY2x1ZGVzKGNvbmRpdGlvbi5fdGhpcyk7XG5cbiAgICAgICAgICBjYXNlIHRoaXMuRE9FU19OT1RfQ09OVEFJTlM6XG4gICAgICAgICAgICByZXR1cm4gIWN1cnJlbnRSZXNwb25zZS5hbnN3ZXIuaW5jbHVkZXMoY29uZGl0aW9uLl90aGlzKTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgfVxuXG5cbn1cbiJdfQ==