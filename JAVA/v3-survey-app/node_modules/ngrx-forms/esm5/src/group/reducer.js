import { AddArrayControlAction, FocusAction, isNgrxFormsAction, RemoveArrayControlAction, UnfocusAction, } from '../actions';
import { isGroupState } from '../state';
import { addControlReducer } from './reducer/add-control';
import { clearAsyncErrorReducer } from './reducer/clear-async-error';
import { disableReducer } from './reducer/disable';
import { enableReducer } from './reducer/enable';
import { markAsDirtyReducer } from './reducer/mark-as-dirty';
import { markAsPristineReducer } from './reducer/mark-as-pristine';
import { markAsSubmittedReducer } from './reducer/mark-as-submitted';
import { markAsTouchedReducer } from './reducer/mark-as-touched';
import { markAsUnsubmittedReducer } from './reducer/mark-as-unsubmitted';
import { markAsUntouchedReducer } from './reducer/mark-as-untouched';
import { removeControlReducer } from './reducer/remove-control';
import { resetReducer } from './reducer/reset';
import { setAsyncErrorReducer } from './reducer/set-async-error';
import { setErrorsReducer } from './reducer/set-errors';
import { setUserDefinedPropertyReducer } from './reducer/set-user-defined-property';
import { setValueReducer } from './reducer/set-value';
import { startAsyncValidationReducer } from './reducer/start-async-validation';
import { childReducer } from './reducer/util';
export function formGroupReducerInternal(state, action) {
    if (!isGroupState(state)) {
        throw new Error('The state must be a group state');
    }
    if (!isNgrxFormsAction(action)) {
        return state;
    }
    if (!action.controlId.startsWith(state.id)) {
        return state;
    }
    switch (action.type) {
        case FocusAction.TYPE:
        case UnfocusAction.TYPE:
        case AddArrayControlAction.TYPE:
        case RemoveArrayControlAction.TYPE:
            return childReducer(state, action);
        default:
            break;
    }
    state = setValueReducer(state, action);
    state = setErrorsReducer(state, action);
    state = startAsyncValidationReducer(state, action);
    state = setAsyncErrorReducer(state, action);
    state = clearAsyncErrorReducer(state, action);
    state = enableReducer(state, action);
    state = disableReducer(state, action);
    state = markAsDirtyReducer(state, action);
    state = markAsPristineReducer(state, action);
    state = markAsTouchedReducer(state, action);
    state = markAsUntouchedReducer(state, action);
    state = markAsSubmittedReducer(state, action);
    state = markAsUnsubmittedReducer(state, action);
    state = addControlReducer(state, action);
    state = removeControlReducer(state, action);
    state = setUserDefinedPropertyReducer(state, action);
    state = resetReducer(state, action);
    return state;
}
/**
 * This reducer function updates a form group state with actions.
 */
export function formGroupReducer(state, action) {
    if (!state) {
        throw new Error('The group state must be defined!');
    }
    return formGroupReducerInternal(state, action);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVkdWNlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25ncngtZm9ybXMvIiwic291cmNlcyI6WyJzcmMvZ3JvdXAvcmVkdWNlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBRUwscUJBQXFCLEVBQ3JCLFdBQVcsRUFDWCxpQkFBaUIsRUFDakIsd0JBQXdCLEVBQ3hCLGFBQWEsR0FDZCxNQUFNLFlBQVksQ0FBQztBQUNwQixPQUFPLEVBQWtCLFlBQVksRUFBWSxNQUFNLFVBQVUsQ0FBQztBQUNsRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbkQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQzdELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNqRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN4RCxPQUFPLEVBQUUsNkJBQTZC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IjpbImltcG9ydCB7IEFjdGlvbiB9IGZyb20gJ0BuZ3J4L3N0b3JlJztcclxuXHJcbmltcG9ydCB7XHJcbiAgQWN0aW9ucyxcclxuICBBZGRBcnJheUNvbnRyb2xBY3Rpb24sXHJcbiAgRm9jdXNBY3Rpb24sXHJcbiAgaXNOZ3J4Rm9ybXNBY3Rpb24sXHJcbiAgUmVtb3ZlQXJyYXlDb250cm9sQWN0aW9uLFxyXG4gIFVuZm9jdXNBY3Rpb24sXHJcbn0gZnJvbSAnLi4vYWN0aW9ucyc7XHJcbmltcG9ydCB7IEZvcm1Hcm91cFN0YXRlLCBpc0dyb3VwU3RhdGUsIEtleVZhbHVlIH0gZnJvbSAnLi4vc3RhdGUnO1xyXG5pbXBvcnQgeyBhZGRDb250cm9sUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9hZGQtY29udHJvbCc7XHJcbmltcG9ydCB7IGNsZWFyQXN5bmNFcnJvclJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvY2xlYXItYXN5bmMtZXJyb3InO1xyXG5pbXBvcnQgeyBkaXNhYmxlUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9kaXNhYmxlJztcclxuaW1wb3J0IHsgZW5hYmxlUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9lbmFibGUnO1xyXG5pbXBvcnQgeyBtYXJrQXNEaXJ0eVJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvbWFyay1hcy1kaXJ0eSc7XHJcbmltcG9ydCB7IG1hcmtBc1ByaXN0aW5lUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXByaXN0aW5lJztcclxuaW1wb3J0IHsgbWFya0FzU3VibWl0dGVkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXN1Ym1pdHRlZCc7XHJcbmltcG9ydCB7IG1hcmtBc1RvdWNoZWRSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL21hcmstYXMtdG91Y2hlZCc7XHJcbmltcG9ydCB7IG1hcmtBc1Vuc3VibWl0dGVkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXVuc3VibWl0dGVkJztcclxuaW1wb3J0IHsgbWFya0FzVW50b3VjaGVkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXVudG91Y2hlZCc7XHJcbmltcG9ydCB7IHJlbW92ZUNvbnRyb2xSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3JlbW92ZS1jb250cm9sJztcclxuaW1wb3J0IHsgcmVzZXRSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3Jlc2V0JztcclxuaW1wb3J0IHsgc2V0QXN5bmNFcnJvclJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvc2V0LWFzeW5jLWVycm9yJztcclxuaW1wb3J0IHsgc2V0RXJyb3JzUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9zZXQtZXJyb3JzJztcclxuaW1wb3J0IHsgc2V0VXNlckRlZmluZWRQcm9wZXJ0eVJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvc2V0LXVzZXItZGVmaW5lZC1wcm9wZXJ0eSc7XHJcbmltcG9ydCB7IHNldFZhbHVlUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9zZXQtdmFsdWUnO1xyXG5pbXBvcnQgeyBzdGFydEFzeW5jVmFsaWRhdGlvblJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvc3RhcnQtYXN5bmMtdmFsaWRhdGlvbic7XHJcbmltcG9ydCB7IGNoaWxkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci91dGlsJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtR3JvdXBSZWR1Y2VySW50ZXJuYWw8VFZhbHVlIGV4dGVuZHMgS2V5VmFsdWU+KHN0YXRlOiBGb3JtR3JvdXBTdGF0ZTxUVmFsdWU+LCBhY3Rpb246IEFjdGlvbnM8VFZhbHVlPikge1xyXG4gIGlmICghaXNHcm91cFN0YXRlKHN0YXRlKSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgc3RhdGUgbXVzdCBiZSBhIGdyb3VwIHN0YXRlJyk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlzTmdyeEZvcm1zQWN0aW9uKGFjdGlvbikpIHtcclxuICAgIHJldHVybiBzdGF0ZTtcclxuICB9XHJcblxyXG4gIGlmICghYWN0aW9uLmNvbnRyb2xJZC5zdGFydHNXaXRoKHN0YXRlLmlkKSkge1xyXG4gICAgcmV0dXJuIHN0YXRlO1xyXG4gIH1cclxuXHJcbiAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xyXG4gICAgY2FzZSBGb2N1c0FjdGlvbi5UWVBFOlxyXG4gICAgY2FzZSBVbmZvY3VzQWN0aW9uLlRZUEU6XHJcbiAgICBjYXNlIEFkZEFycmF5Q29udHJvbEFjdGlvbi5UWVBFOlxyXG4gICAgY2FzZSBSZW1vdmVBcnJheUNvbnRyb2xBY3Rpb24uVFlQRTpcclxuICAgICAgcmV0dXJuIGNoaWxkUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuXHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICBicmVhaztcclxuICB9XHJcblxyXG4gIHN0YXRlID0gc2V0VmFsdWVSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gc2V0RXJyb3JzUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IHN0YXJ0QXN5bmNWYWxpZGF0aW9uUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IHNldEFzeW5jRXJyb3JSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gY2xlYXJBc3luY0Vycm9yUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IGVuYWJsZVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBkaXNhYmxlUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IG1hcmtBc0RpcnR5UmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IG1hcmtBc1ByaXN0aW5lUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IG1hcmtBc1RvdWNoZWRSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gbWFya0FzVW50b3VjaGVkUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IG1hcmtBc1N1Ym1pdHRlZFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBtYXJrQXNVbnN1Ym1pdHRlZFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBhZGRDb250cm9sUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IHJlbW92ZUNvbnRyb2xSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gc2V0VXNlckRlZmluZWRQcm9wZXJ0eVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSByZXNldFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcblxyXG4gIHJldHVybiBzdGF0ZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgcmVkdWNlciBmdW5jdGlvbiB1cGRhdGVzIGEgZm9ybSBncm91cCBzdGF0ZSB3aXRoIGFjdGlvbnMuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZm9ybUdyb3VwUmVkdWNlcjxUVmFsdWUgZXh0ZW5kcyBLZXlWYWx1ZT4oc3RhdGU6IEZvcm1Hcm91cFN0YXRlPFRWYWx1ZT4gfCB1bmRlZmluZWQsIGFjdGlvbjogQWN0aW9uKSB7XHJcbiAgaWYgKCFzdGF0ZSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgZ3JvdXAgc3RhdGUgbXVzdCBiZSBkZWZpbmVkIScpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGZvcm1Hcm91cFJlZHVjZXJJbnRlcm5hbChzdGF0ZSwgYWN0aW9uIGFzIGFueSk7XHJcbn1cclxuIl19