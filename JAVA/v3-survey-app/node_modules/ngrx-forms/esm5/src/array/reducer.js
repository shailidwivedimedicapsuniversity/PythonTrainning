import { AddGroupControlAction, FocusAction, isNgrxFormsAction, RemoveGroupControlAction, UnfocusAction, } from '../actions';
import { isArrayState } from '../state';
import { addControlReducer } from './reducer/add-control';
import { clearAsyncErrorReducer } from './reducer/clear-async-error';
import { disableReducer } from './reducer/disable';
import { enableReducer } from './reducer/enable';
import { markAsDirtyReducer } from './reducer/mark-as-dirty';
import { markAsPristineReducer } from './reducer/mark-as-pristine';
import { markAsSubmittedReducer } from './reducer/mark-as-submitted';
import { markAsTouchedReducer } from './reducer/mark-as-touched';
import { markAsUnsubmittedReducer } from './reducer/mark-as-unsubmitted';
import { markAsUntouchedReducer } from './reducer/mark-as-untouched';
import { moveControlReducer } from './reducer/move-control';
import { removeControlReducer } from './reducer/remove-control';
import { resetReducer } from './reducer/reset';
import { setAsyncErrorReducer } from './reducer/set-async-error';
import { setErrorsReducer } from './reducer/set-errors';
import { setUserDefinedPropertyReducer } from './reducer/set-user-defined-property';
import { setValueReducer } from './reducer/set-value';
import { startAsyncValidationReducer } from './reducer/start-async-validation';
import { swapControlReducer } from './reducer/swap-control';
import { childReducer } from './reducer/util';
export function formArrayReducerInternal(state, action) {
    if (!isArrayState(state)) {
        throw new Error('The state must be an array state');
    }
    if (!isNgrxFormsAction(action)) {
        return state;
    }
    if (!action.controlId.startsWith(state.id)) {
        return state;
    }
    switch (action.type) {
        case FocusAction.TYPE:
        case UnfocusAction.TYPE:
        case AddGroupControlAction.TYPE:
        case RemoveGroupControlAction.TYPE:
            return childReducer(state, action);
        default:
            break;
    }
    state = setValueReducer(state, action);
    state = setErrorsReducer(state, action);
    state = startAsyncValidationReducer(state, action);
    state = setAsyncErrorReducer(state, action);
    state = clearAsyncErrorReducer(state, action);
    state = enableReducer(state, action);
    state = disableReducer(state, action);
    state = markAsDirtyReducer(state, action);
    state = markAsPristineReducer(state, action);
    state = markAsTouchedReducer(state, action);
    state = markAsUntouchedReducer(state, action);
    state = markAsSubmittedReducer(state, action);
    state = markAsUnsubmittedReducer(state, action);
    state = setUserDefinedPropertyReducer(state, action);
    state = resetReducer(state, action);
    state = addControlReducer(state, action);
    state = removeControlReducer(state, action);
    state = swapControlReducer(state, action);
    state = moveControlReducer(state, action);
    return state;
}
/**
 * This reducer function updates a form array state with actions.
 */
export function formArrayReducer(state, action) {
    if (!state) {
        throw new Error('The array state must be defined!');
    }
    return formArrayReducerInternal(state, action);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVkdWNlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25ncngtZm9ybXMvIiwic291cmNlcyI6WyJzcmMvYXJyYXkvcmVkdWNlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBRUwscUJBQXFCLEVBQ3JCLFdBQVcsRUFDWCxpQkFBaUIsRUFDakIsd0JBQXdCLEVBQ3hCLGFBQWEsR0FDZCxNQUFNLFlBQVksQ0FBQztBQUNwQixPQUFPLEVBQWtCLFlBQVksRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUN4RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbkQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQzdELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzVELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNqRSxPQUFPLEVBQUUsZ0JBQWdC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RUc7QUFDSCxNQUFNLFVBQVUsZ0JBQWdCLENBQVMsS0FBeUMsRUFBRSxNQUFjO0lBQ2hHLElBQUksQ0FBQyxLQUFLLEVBQUU7UUFDVixNQUFNLElBQUksS0FBSyxDQUFDLGtDQUFrQyxDQUFDLENBQUM7S0FDckQ7SUFFRCxPQUFPLHdCQUF3QixDQUFDLEtBQUssRUFBRSxNQUFhLENBQUMsQ0FBQztBQUN4RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAnQG5ncngvc3RvcmUnO1xyXG5cclxuaW1wb3J0IHtcclxuICBBY3Rpb25zLFxyXG4gIEFkZEdyb3VwQ29udHJvbEFjdGlvbixcclxuICBGb2N1c0FjdGlvbixcclxuICBpc05ncnhGb3Jtc0FjdGlvbixcclxuICBSZW1vdmVHcm91cENvbnRyb2xBY3Rpb24sXHJcbiAgVW5mb2N1c0FjdGlvbixcclxufSBmcm9tICcuLi9hY3Rpb25zJztcclxuaW1wb3J0IHsgRm9ybUFycmF5U3RhdGUsIGlzQXJyYXlTdGF0ZSB9IGZyb20gJy4uL3N0YXRlJztcclxuaW1wb3J0IHsgYWRkQ29udHJvbFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvYWRkLWNvbnRyb2wnO1xyXG5pbXBvcnQgeyBjbGVhckFzeW5jRXJyb3JSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL2NsZWFyLWFzeW5jLWVycm9yJztcclxuaW1wb3J0IHsgZGlzYWJsZVJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvZGlzYWJsZSc7XHJcbmltcG9ydCB7IGVuYWJsZVJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvZW5hYmxlJztcclxuaW1wb3J0IHsgbWFya0FzRGlydHlSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL21hcmstYXMtZGlydHknO1xyXG5pbXBvcnQgeyBtYXJrQXNQcmlzdGluZVJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvbWFyay1hcy1wcmlzdGluZSc7XHJcbmltcG9ydCB7IG1hcmtBc1N1Ym1pdHRlZFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvbWFyay1hcy1zdWJtaXR0ZWQnO1xyXG5pbXBvcnQgeyBtYXJrQXNUb3VjaGVkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9tYXJrLWFzLXRvdWNoZWQnO1xyXG5pbXBvcnQgeyBtYXJrQXNVbnN1Ym1pdHRlZFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvbWFyay1hcy11bnN1Ym1pdHRlZCc7XHJcbmltcG9ydCB7IG1hcmtBc1VudG91Y2hlZFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvbWFyay1hcy11bnRvdWNoZWQnO1xyXG5pbXBvcnQgeyBtb3ZlQ29udHJvbFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvbW92ZS1jb250cm9sJztcclxuaW1wb3J0IHsgcmVtb3ZlQ29udHJvbFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvcmVtb3ZlLWNvbnRyb2wnO1xyXG5pbXBvcnQgeyByZXNldFJlZHVjZXIgfSBmcm9tICcuL3JlZHVjZXIvcmVzZXQnO1xyXG5pbXBvcnQgeyBzZXRBc3luY0Vycm9yUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9zZXQtYXN5bmMtZXJyb3InO1xyXG5pbXBvcnQgeyBzZXRFcnJvcnNSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3NldC1lcnJvcnMnO1xyXG5pbXBvcnQgeyBzZXRVc2VyRGVmaW5lZFByb3BlcnR5UmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9zZXQtdXNlci1kZWZpbmVkLXByb3BlcnR5JztcclxuaW1wb3J0IHsgc2V0VmFsdWVSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3NldC12YWx1ZSc7XHJcbmltcG9ydCB7IHN0YXJ0QXN5bmNWYWxpZGF0aW9uUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci9zdGFydC1hc3luYy12YWxpZGF0aW9uJztcclxuaW1wb3J0IHsgc3dhcENvbnRyb2xSZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2VyL3N3YXAtY29udHJvbCc7XHJcbmltcG9ydCB7IGNoaWxkUmVkdWNlciB9IGZyb20gJy4vcmVkdWNlci91dGlsJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtQXJyYXlSZWR1Y2VySW50ZXJuYWw8VFZhbHVlPihzdGF0ZTogRm9ybUFycmF5U3RhdGU8VFZhbHVlPiwgYWN0aW9uOiBBY3Rpb25zPFRWYWx1ZVtdPikge1xyXG4gIGlmICghaXNBcnJheVN0YXRlKHN0YXRlKSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgc3RhdGUgbXVzdCBiZSBhbiBhcnJheSBzdGF0ZScpO1xyXG4gIH1cclxuXHJcbiAgaWYgKCFpc05ncnhGb3Jtc0FjdGlvbihhY3Rpb24pKSB7XHJcbiAgICByZXR1cm4gc3RhdGU7XHJcbiAgfVxyXG5cclxuICBpZiAoIWFjdGlvbi5jb250cm9sSWQuc3RhcnRzV2l0aChzdGF0ZS5pZCkpIHtcclxuICAgIHJldHVybiBzdGF0ZTtcclxuICB9XHJcblxyXG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcclxuICAgIGNhc2UgRm9jdXNBY3Rpb24uVFlQRTpcclxuICAgIGNhc2UgVW5mb2N1c0FjdGlvbi5UWVBFOlxyXG4gICAgY2FzZSBBZGRHcm91cENvbnRyb2xBY3Rpb24uVFlQRTpcclxuICAgIGNhc2UgUmVtb3ZlR3JvdXBDb250cm9sQWN0aW9uLlRZUEU6XHJcbiAgICAgIHJldHVybiBjaGlsZFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcblxyXG4gICAgZGVmYXVsdDpcclxuICAgICAgYnJlYWs7XHJcbiAgfVxyXG5cclxuICBzdGF0ZSA9IHNldFZhbHVlUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IHNldEVycm9yc1JlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBzdGFydEFzeW5jVmFsaWRhdGlvblJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBzZXRBc3luY0Vycm9yUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IGNsZWFyQXN5bmNFcnJvclJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBlbmFibGVSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gZGlzYWJsZVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBtYXJrQXNEaXJ0eVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBtYXJrQXNQcmlzdGluZVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBtYXJrQXNUb3VjaGVkUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IG1hcmtBc1VudG91Y2hlZFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBtYXJrQXNTdWJtaXR0ZWRSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gbWFya0FzVW5zdWJtaXR0ZWRSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gc2V0VXNlckRlZmluZWRQcm9wZXJ0eVJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSByZXNldFJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XHJcbiAgc3RhdGUgPSBhZGRDb250cm9sUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcclxuICBzdGF0ZSA9IHJlbW92ZUNvbnRyb2xSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gc3dhcENvbnRyb2xSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG4gIHN0YXRlID0gbW92ZUNvbnRyb2xSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pO1xyXG5cclxuICByZXR1cm4gc3RhdGU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGlzIHJlZHVjZXIgZnVuY3Rpb24gdXBkYXRlcyBhIGZvcm0gYXJyYXkgc3RhdGUgd2l0aCBhY3Rpb25zLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1BcnJheVJlZHVjZXI8VFZhbHVlPihzdGF0ZTogRm9ybUFycmF5U3RhdGU8VFZhbHVlPiB8IHVuZGVmaW5lZCwgYWN0aW9uOiBBY3Rpb24pIHtcclxuICBpZiAoIXN0YXRlKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBhcnJheSBzdGF0ZSBtdXN0IGJlIGRlZmluZWQhJyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZm9ybUFycmF5UmVkdWNlckludGVybmFsKHN0YXRlLCBhY3Rpb24gYXMgYW55KTtcclxufVxyXG4iXX0=