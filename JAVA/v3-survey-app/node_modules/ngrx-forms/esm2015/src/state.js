import { isBoxed } from './boxing';
import { deepEquals, isEmpty } from './util';
/**
 * This function determines if a value is a form state.
 */
export function isFormState(state) {
    return !!state && state.hasOwnProperty('id') && state.hasOwnProperty('value') && state.hasOwnProperty('errors');
}
/**
 * This function determines if a value is an array state.
 */
export function isArrayState(state) {
    return isFormState(state) && state.hasOwnProperty('controls') && Array.isArray(state.controls);
}
/**
 * This function determines if a value is a group state.
 */
export function isGroupState(state) {
    return isFormState(state) && state.hasOwnProperty('controls') && !Array.isArray(state.controls) && typeof state.controls !== 'function';
}
export function createChildState(id, childValue) {
    if (isBoxed(childValue)) {
        return createFormControlState(id, childValue);
    }
    if (childValue !== null && Array.isArray(childValue)) {
        return createFormArrayState(id, childValue);
    }
    if (childValue !== null && typeof childValue === 'object') {
        return createFormGroupState(id, childValue);
    }
    return createFormControlState(id, childValue);
}
export function verifyFormControlValueIsValid(value) {
    if (value === null || ['string', 'number', 'boolean', 'undefined'].indexOf(typeof value) >= 0) {
        return value;
    }
    if (!isBoxed(value)) {
        const errorMsg = 'Form control states only support undefined, null, string, number, and boolean values as well as boxed values';
        throw new Error(`${errorMsg}; got ${JSON.stringify(value)} of type ${typeof value}`); // `;
    }
    if (value.value === null || ['string', 'number', 'boolean', 'undefined'].indexOf(typeof value.value) >= 0) {
        return value;
    }
    const serialized = JSON.stringify(value);
    const deserialized = JSON.parse(serialized);
    if (deepEquals(value, deserialized)) {
        return value;
    }
    throw new Error(`A form control value must be serializable (i.e. value === JSON.parse(JSON.stringify(value))), got: ${JSON.stringify(value)}`);
}
/**
 * This function creates a form control state with an ID and a value.
 */
export function createFormControlState(id, value) {
    return {
        id,
        value: verifyFormControlValueIsValid(value),
        errors: {},
        pendingValidations: [],
        isValidationPending: false,
        isValid: true,
        isInvalid: false,
        isEnabled: true,
        isDisabled: false,
        isDirty: false,
        isPristine: true,
        isTouched: false,
        isUntouched: true,
        isSubmitted: false,
        isUnsubmitted: true,
        isFocused: false,
        isUnfocused: true,
        userDefinedProperties: {},
    };
}
export function getFormGroupValue(controls, originalValue) {
    let hasChanged = Object.keys(originalValue).length !== Object.keys(controls).length;
    const newValue = Object.keys(controls).reduce((res, key) => {
        hasChanged = hasChanged || originalValue[key] !== controls[key].value;
        res[key] = controls[key].value;
        return res;
    }, {});
    return hasChanged ? newValue : originalValue;
}
export function getFormGroupErrors(controls, originalErrors) {
    let hasChanged = false;
    const groupErrors = Object.keys(originalErrors)
        .filter(key => !key.startsWith('_'))
        .reduce((res, key) => Object.assign(res, { [key]: originalErrors[key] }), {});
    const newErrors = Object.keys(controls).reduce((res, key) => {
        const controlErrors = controls[key].errors;
        if (!isEmpty(controlErrors)) {
            hasChanged = hasChanged || originalErrors[`_${key}`] !== controlErrors;
            Object.assign(res, { [`_${key}`]: controls[key].errors });
        }
        else {
            hasChanged = hasChanged || originalErrors.hasOwnProperty(`_${key}`);
        }
        return res;
    }, groupErrors);
    hasChanged = hasChanged || Object.keys(originalErrors).length !== Object.keys(newErrors).length;
    return hasChanged ? newErrors : originalErrors;
}
export function computeGroupState(id, controls, value, errors, pendingValidations, userDefinedProperties, flags) {
    value = getFormGroupValue(controls, value);
    errors = getFormGroupErrors(controls, errors);
    const isValid = isEmpty(errors);
    const isDirty = flags.wasOrShouldBeDirty || Object.keys(controls).some(key => controls[key].isDirty);
    const isEnabled = flags.wasOrShouldBeEnabled || Object.keys(controls).some(key => controls[key].isEnabled);
    const isTouched = flags.wasOrShouldBeTouched || Object.keys(controls).some(key => controls[key].isTouched);
    const isSubmitted = flags.wasOrShouldBeSubmitted || Object.keys(controls).some(key => controls[key].isSubmitted);
    const isValidationPending = pendingValidations.length > 0 || Object.keys(controls).some(key => controls[key].isValidationPending);
    return {
        id,
        value,
        errors,
        pendingValidations,
        isValidationPending,
        isValid,
        isInvalid: !isValid,
        isEnabled,
        isDisabled: !isEnabled,
        isDirty,
        isPristine: !isDirty,
        isTouched,
        isUntouched: !isTouched,
        isSubmitted,
        isUnsubmitted: !isSubmitted,
        userDefinedProperties,
        controls,
    };
}
/**
 * This function creates a form group state with an ID and a value.
 * From the value the shape of the group state is inferred, i.e.
 * object properties are inferred as form groups, array properties
 * are inferred as form arrays, and primitive properties are inferred
 * as form controls.
 */
export function createFormGroupState(id, initialValue) {
    const controls = Object.keys(initialValue)
        .map((key) => [key, createChildState(`${id}.${key}`, initialValue[key])])
        .reduce((res, [controlId, state]) => Object.assign(res, { [controlId]: state }), {});
    return computeGroupState(id, controls, initialValue, {}, [], {}, { wasOrShouldBeEnabled: true });
}
function getFormArrayValue(controls, originalValue) {
    let hasChanged = Object.keys(originalValue).length !== Object.keys(controls).length;
    const newValue = controls.map((state, i) => {
        hasChanged = hasChanged || originalValue[i] !== state.value;
        return state.value;
    });
    return hasChanged ? newValue : originalValue;
}
function getFormArrayErrors(controls, originalErrors) {
    let hasChanged = false;
    const groupErrors = Object.keys(originalErrors)
        .filter(key => !key.startsWith('_'))
        .reduce((res, key) => Object.assign(res, { [key]: originalErrors[key] }), {});
    const newErrors = controls.reduce((res, state, i) => {
        const controlErrors = state.errors;
        if (!isEmpty(controlErrors)) {
            hasChanged = hasChanged || originalErrors[`_${i}`] !== controlErrors;
            Object.assign(res, { [`_${i}`]: controlErrors });
        }
        else {
            hasChanged = hasChanged || originalErrors.hasOwnProperty(`_${i}`);
        }
        return res;
    }, groupErrors);
    hasChanged = hasChanged || Object.keys(originalErrors).length !== Object.keys(newErrors).length;
    return hasChanged ? newErrors : originalErrors;
}
export function computeArrayState(id, inferredControls, value, errors, pendingValidations, userDefinedProperties, flags) {
    const controls = inferredControls;
    value = getFormArrayValue(controls, value);
    errors = getFormArrayErrors(controls, errors);
    const isValid = isEmpty(errors);
    const isDirty = flags.wasOrShouldBeDirty || controls.some(state => state.isDirty);
    const isEnabled = flags.wasOrShouldBeEnabled || controls.some(state => state.isEnabled);
    const isTouched = flags.wasOrShouldBeTouched || controls.some(state => state.isTouched);
    const isSubmitted = flags.wasOrShouldBeSubmitted || controls.some(state => state.isSubmitted);
    const isValidationPending = pendingValidations.length > 0 || controls.some(state => state.isValidationPending);
    return {
        id,
        value,
        errors,
        pendingValidations,
        isValidationPending,
        isValid,
        isInvalid: !isValid,
        isEnabled,
        isDisabled: !isEnabled,
        isDirty,
        isPristine: !isDirty,
        isTouched,
        isUntouched: !isTouched,
        isSubmitted,
        isUnsubmitted: !isSubmitted,
        userDefinedProperties,
        controls: inferredControls,
    };
}
/**
 * This function creates a form array state with an ID and a value.
 * From the value the shape of the array state is inferred, i.e.
 * object values are inferred as form groups, array values
 * are inferred as form arrays, and primitive values are inferred
 * as form controls.
 */
export function createFormArrayState(id, initialValue) {
    const controls = initialValue
        .map((value, i) => createChildState(`${id}.${i}`, value));
    return computeArrayState(id, controls, initialValue, {}, [], {}, { wasOrShouldBeEnabled: true });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3J4LWZvcm1zLyIsInNvdXJjZXMiOlsic3JjL3N0YXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBUyxPQUFPLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDMUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxRQUFRLENBQUM7QUE2a0I3Qzs7R0FFRztBQUNILE1BQU0sVUFBVSxXQUFXLENBQWUsS0FBVTtJQUNsRCxPQUFPLENBQUMsQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDbEgsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxVQUFVLFlBQVksQ0FBZSxLQUFVO0lBQ25ELE9BQU8sV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBRSxLQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDMUcsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxVQUFVLFlBQVksQ0FBZSxLQUFVO0lBQ25ELE9BQU8sV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFFLEtBQWEsQ0FBQyxRQUFRLENBQUMsSUFBSSxPQUFRLEtBQWEsQ0FBQyxRQUFRLEtBQUssVUFBVSxDQUFDO0FBQzVKLENBQUM7QUFFRCxNQUFNLFVBQVUsZ0JBQWdCLENBQVMsRUFBVSxFQUFFLFVBQWtCO0lBQ3JFLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO1FBQ3ZCLE9BQU8sc0JBQXNCLENBQU0sRUFBRSxFQUFFLFVBQVUsQ0FBc0IsQ0FBQztL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QUksUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0lBQy9HLE9BQU87UUFDTCxFQUFFO1FBQ0YsS0FBSztRQUNMLE1BQU07UUFDTixrQkFBa0I7UUFDbEIsbUJBQW1CO1FBQ25CLE9BQU87UUFDUCxTQUFTLEVBQUUsQ0FBQyxPQUFPO1FBQ25CLFNBQVM7UUFDVCxVQUFVLEVBQUUsQ0FBQyxTQUFTO1FBQ3RCLE9BQU87UUFDUCxVQUFVLEVBQUUsQ0FBQyxPQUFPO1FBQ3BCLFNBQVM7UUFDVCxXQUFXLEVBQUUsQ0FBQyxTQUFTO1FBQ3ZCLFdBQVc7UUFDWCxhQUFhLEVBQUUsQ0FBQyxXQUFXO1FBQzNCLHFCQUFxQjtRQUNyQixRQUFRLEVBQUUsZ0JBQWdCO0tBQzNCLENBQUM7QUFDSixDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0gsTUFBTSxVQUFVLG9CQUFvQixDQUNsQyxFQUFxQixFQUNyQixZQUFzQjtJQUV0QixNQUFNLFFBQVEsR0FBRyxZQUFZO1NBQzFCLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFFNUQsT0FBTyxpQkFBaUIsQ0FBQyxFQUFFLEVBQUUsUUFBUSxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLG9CQUFvQixFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7QUFDbkcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJveGVkLCBpc0JveGVkIH0gZnJvbSAnLi9ib3hpbmcnO1xyXG5pbXBvcnQgeyBkZWVwRXF1YWxzLCBpc0VtcHR5IH0gZnJvbSAnLi91dGlsJztcclxuXHJcbmV4cG9ydCB0eXBlIEZvcm1Db250cm9sVmFsdWVUeXBlcyA9IEJveGVkPGFueT4gfCBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuIHwgbnVsbCB8IHVuZGVmaW5lZDtcclxuZXhwb3J0IHR5cGUgTmdyeEZvcm1Db250cm9sSWQgPSBzdHJpbmc7XHJcblxyXG4vKipcclxuICogVGhpcyB0eXBlIHJlcHJlc2VudHMgYSBjb2xsZWN0aW9uIG9mIG5hbWVkIGVycm9ycy5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvbkVycm9ycyB7IHJlYWRvbmx5IFtrZXk6IHN0cmluZ106IGFueTsgfVxyXG5leHBvcnQgaW50ZXJmYWNlIEtleVZhbHVlIHsgW2tleTogc3RyaW5nXTogYW55OyB9XHJcblxyXG4vKipcclxuICogQmFzZSBpbnRlcmZhY2UgZm9yIGFsbCB0eXBlcyBvZiBmb3JtIHN0YXRlcy5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQWJzdHJhY3RDb250cm9sU3RhdGU8VFZhbHVlPiB7XHJcbiAgLyoqXHJcbiAgICogVGhlIHVuaXF1ZSBJRCBvZiB0aGUgZm9ybSBzdGF0ZS4gVXN1YWxseSB0aGlzIGlzIHRoZSBuYW1lIG9yIGluZGV4XHJcbiAgICogb2YgdGhlIGNvbnRyb2wgaW4gdGhlIGZvcm0gdmFsdWUgcHJlZml4ZWQgYnkgdGhlIElEIG9mIHRoZSBjb250YWluaW5nXHJcbiAgICogZ3JvdXAgb3IgYXJyYXksIGUuZy4gYE1ZX0ZPUk0uc29tZVRleHRJbnB1dGAgb3IgYE1ZX0ZPUk0uMGAuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaWQ6IHN0cmluZztcclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBmb3JtIHN0YXRlLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IHZhbHVlOiBUVmFsdWU7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIHRoZSBzdGF0ZSBkb2VzIG5vdCBoYXZlIGFueSBlcnJvcnMuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNWYWxpZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIHN0YXRlIGhhcyBhdCBsZWFzdCBvbmUgZXJyb3IuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNJbnZhbGlkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgZXJyb3JzIG9mIHRoZSBzdGF0ZS4gVGhpcyBwcm9wZXJ0eSBhbHdheXMgaGFzIGEgdmFsdWUuXHJcbiAgICogSWYgdGhlIHN0YXRlIGhhcyBubyBlcnJvcnMgdGhlIHByb3BlcnR5IGlzIHNldCB0byBge31gLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGVycm9yczogVmFsaWRhdGlvbkVycm9ycztcclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIG5hbWVzIG9mIGFsbCBhc3luY2hyb25vdXMgdmFsaWRhdGlvbnMgY3VycmVudGx5IHJ1bm5pbmdcclxuICAgKiBmb3IgdGhlIHN0YXRlLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IHBlbmRpbmdWYWxpZGF0aW9uczogcmVhZG9ubHkgc3RyaW5nW107XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGNvbnRyb2wgaXMgY3VycmVudGx5IGJlaW5nXHJcbiAgICogYXN5bmNocm9ub3VzbHkgdmFsaWRhdGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzVmFsaWRhdGlvblBlbmRpbmc6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN0YXRlIGlzIGVuYWJsZWQuIFdoZW4gaXRcclxuICAgKiBpcyBgZmFsc2VgIHRoZSBgZXJyb3JzYCBhcmUgYWx3YXlzIGB7fWAgKGkuZS4gdGhlIHN0YXRlIGlzXHJcbiAgICogYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2AgaXMgYWx3YXlzIGBbXWBcclxuICAgKiAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cclxuICAgKi9cclxuICByZWFkb25seSBpc0VuYWJsZWQ6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN0YXRlIGlzIGRpc2FibGVkLiBXaGVuIGl0XHJcbiAgICogaXMgYHRydWVgIHRoZSBgZXJyb3JzYCBhcmUgYWx3YXlzIGB7fWAgKGkuZS4gdGhlIHN0YXRlIGlzXHJcbiAgICogYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2AgaXMgYWx3YXlzIGBbXWBcclxuICAgKiAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cclxuICAgKi9cclxuICByZWFkb25seSBpc0Rpc2FibGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgc3RhdGUncyB2YWx1ZSBjaGFuZ2VzLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzRGlydHk6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGFzIGxvbmcgYXMgdGhlIHN0YXRlJ3MgdmFsdWUgbmV2ZXIgY2hhbmdlZC5cclxuICAgKi9cclxuICByZWFkb25seSBpc1ByaXN0aW5lOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgc3RhdGUgaXMgdG91Y2hlZC5cclxuICAgKi9cclxuICByZWFkb25seSBpc1RvdWNoZWQ6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGFzIGxvbmcgYXMgdGhlIHN0YXRlIGlzIG5vdCB0b3VjaGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzVW50b3VjaGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgc3RhdGUgaXMgc3VibWl0dGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzU3VibWl0dGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSBzdGF0ZSBpcyBub3Qgc3VibWl0dGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzVW5zdWJtaXR0ZWQ6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYSBjb250YWluZXIgZm9yIHVzZXItZGVmaW5lZCBtZXRhZGF0YSAoZS5nLiBpZlxyXG4gICAqIHlvdSB3YW50ZWQgdG8gY291bnQgdGhlIG51bWJlciBvZiB0aW1lcyBhIHN0YXRlJ3MgdmFsdWUgaGFzIGJlZW5cclxuICAgKiBjaGFuZ2VkLCB3aGF0IGtleXMgd2VyZSBwcmVzc2VkIG9uIGFuIGlucHV0LCBvciBob3cgb2Z0ZW4gYSBmb3JtXHJcbiAgICogaGFzIGJlZW4gc3VibWl0dGVkIGV0Yy4pLiBXaGlsZSBpdCBpcyBwb3NzaWJsZSB0byBzdG9yZSB0aGlzIGtpbmRcclxuICAgKiBvZiBpbmZvcm1hdGlvbiBvdXRzaWRlIG9mICoqbmdyeC1mb3JtcyoqIGluIHlvdXIgb3duIHN0YXRlIHRoZVxyXG4gICAqIGB1c2VyRGVmaW5lZFByb3BlcnRpZXNgIGFsbG93IHlvdSB0byBzdG9yZSB5b3VyIG93biBtZXRhZGF0YVxyXG4gICAqIGRpcmVjdGx5IGluIHRoZSBzdGF0ZS5cclxuICAgKi9cclxuICByZWFkb25seSB1c2VyRGVmaW5lZFByb3BlcnRpZXM6IEtleVZhbHVlO1xyXG59XHJcblxyXG4vKipcclxuICogU3RhdGUgYXNzb2NpYXRlZCB3aXRoIGEgZm9ybSBjb250cm9sLCBpLmUuIGFuIEhUTUwgZm9ybVxyXG4gKiBlbGVtZW50IGluIHRoZSB2aWV3IChlLmcuIGBpbnB1dGAsIGBzZWxlY3RgLCBgdGV4dGFyZWFgIGV0Yy4pLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBGb3JtQ29udHJvbFN0YXRlPFRWYWx1ZSBleHRlbmRzIEZvcm1Db250cm9sVmFsdWVUeXBlcz4gZXh0ZW5kcyBBYnN0cmFjdENvbnRyb2xTdGF0ZTxUVmFsdWU+IHtcclxuICAvKipcclxuICAgKiBUaGUgdmFsdWUgb2YgdGhlIGZvcm0gc3RhdGUuIEZvcm0gY29udHJvbHMgb25seSBzdXBwb3J0IHZhbHVlcyBvZlxyXG4gICAqIHR5cGUgYHN0cmluZ2AsIGBudW1iZXJgLCBgYm9vbGVhbmAsIGBudWxsYCwgYW5kIGB1bmRlZmluZWRgIHRvXHJcbiAgICoga2VlcCB0aGUgc3RhdGUgc3RyaW5nIHNlcmlhbGl6YWJsZS5cclxuICAgKi9cclxuICByZWFkb25seSB2YWx1ZTogVFZhbHVlO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiB0aGUgZm9ybSBjb250cm9sIGRvZXMgbm90IGhhdmUgYW55IGVycm9ycy5cclxuICAgKi9cclxuICByZWFkb25seSBpc1ZhbGlkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiB0aGUgZm9ybSBjb250cm9sIGhhcyBhdCBsZWFzdCBvbmUgZXJyb3IuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNJbnZhbGlkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgZXJyb3JzIG9mIHRoZSBmb3JtIGNvbnRyb2wuIFRoaXMgcHJvcGVydHkgYWx3YXlzIGhhcyBhIHZhbHVlLlxyXG4gICAqIElmIHRoZSBjb250cm9sIGhhcyBubyBlcnJvcnMgdGhlIHByb3BlcnR5IGlzIHNldCB0byBge31gLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGVycm9yczogVmFsaWRhdGlvbkVycm9ycztcclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIG5hbWVzIG9mIGFsbCBhc3luY2hyb25vdXMgdmFsaWRhdGlvbnMgY3VycmVudGx5IHJ1bm5pbmcgZm9yIHRoZVxyXG4gICAqIGZvcm0gY29udHJvbC5cclxuICAgKi9cclxuICByZWFkb25seSBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBjb250cm9sIGlzIGN1cnJlbnRseSBiZWluZ1xyXG4gICAqIGFzeW5jaHJvbm91c2x5IHZhbGlkYXRlZCAoaS5lLiB0aGlzIGlzIGB0cnVlYCBpZiBhbmQgb25seSBpZlxyXG4gICAqIGBwZW5kaW5nVmFsaWRhdGlvbnNgIGlzIG5vdCBlbXB0eSkuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNWYWxpZGF0aW9uUGVuZGluZzogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpbmRpY2F0ZXMgd2hldGhlciB0aGUgZm9ybSBjb250cm9sIGlzIGVuYWJsZWQuXHJcbiAgICogV2hlbiBpdCBpcyBgZmFsc2VgIHRoZSBgZXJyb3JzYCBhcmUgYWx3YXlzIGB7fWAgKGkuZS4gdGhlIGZvcm1cclxuICAgKiBjb250cm9sIGlzIGFsd2F5cyB2YWxpZCBpZiBkaXNhYmxlZCkgYW5kIGBwZW5kaW5nVmFsaWRhdGlvbnNgXHJcbiAgICogaXMgYWx3YXlzIGBbXWAgKGkuZS4gYWxsIHBlbmRpbmcgdmFsaWRhdGlvbnMgYXJlIGNhbmNlbGxlZCkuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNFbmFibGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBmb3JtIGNvbnRyb2wgaXMgZGlzYWJsZWQuXHJcbiAgICogV2hlbiBpdCBpcyBgdHJ1ZWAgdGhlIGBlcnJvcnNgIGFyZSBhbHdheXMgYHt9YCAoaS5lLiB0aGUgZm9ybVxyXG4gICAqIGNvbnRyb2wgaXMgYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2BcclxuICAgKiBpcyBhbHdheXMgYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cclxuICAgKi9cclxuICByZWFkb25seSBpc0Rpc2FibGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgdW5kZXJseWluZ1xyXG4gICAqIGBGb3JtVmlld0FkYXB0ZXJgIG9yIGBDb250cm9sVmFsdWVBY2Nlc3NvcmAgcmVwb3J0cyBhIG5ld1xyXG4gICAqIHZhbHVlIGZvciB0aGUgZmlyc3QgdGltZS5cclxuICAgKi9cclxuICByZWFkb25seSBpc0RpcnR5OiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSB1bmRlcmx5aW5nXHJcbiAgICogYEZvcm1WaWV3QWRhcHRlcmAgb3IgYENvbnRyb2xWYWx1ZUFjY2Vzc29yYCBoYXMgbmV2ZXJcclxuICAgKiByZXBvcnRlZCBhIG5ldyB2YWx1ZS5cclxuICAgKi9cclxuICByZWFkb25seSBpc1ByaXN0aW5lOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYmFzZWQgb24gdGhlIHJ1bGVzIG9mIHRoZVxyXG4gICAqIHVuZGVybHlpbmcgYEZvcm1WaWV3QWRhcHRlcmAgKHVzdWFsbHkgb24gYGJsdXJgIGZvciBtb3N0IGZvcm1cclxuICAgKiBlbGVtZW50cykuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNUb3VjaGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBhcyBsb25nIGFzIHRoZSBjb250cm9sIGlzIG5vdCB0b3VjaGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzVW50b3VjaGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWAgYXMgc29vbiBhcyB0aGUgZ3JvdXAgb3IgYXJyYXlcclxuICAgKiBjb250YWluaW5nIHRoaXMgZm9ybSBjb250cm9sIGlzIHN1Ym1pdHRlZC4gQSBmb3JtIGNvbnRyb2wgY2FuXHJcbiAgICogbmV2ZXIgYmUgc3VibWl0dGVkIG9uIGl0cyBvd24uXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNTdWJtaXR0ZWQ6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGFzIGxvbmcgYXMgdGhlIHN0YXRlIGlzIG5vdCBzdWJtaXR0ZWQuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNVbnN1Ym1pdHRlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBzZXQgdG8gYHRydWVgIGlmIHRoZSBmb3JtIGNvbnRyb2wgY3VycmVudGx5XHJcbiAgICogaGFzIGZvY3VzLiBUaGlzIGZlYXR1cmUgaXMgb3B0LWluLiBUbyBlbmFibGUgaXQgeW91IGhhdmUgdG9cclxuICAgKiBlbmFibGUgaXQgZm9yIGEgZ2l2ZW4gZm9ybSBlbGVtZW50IGxpa2UgdGhpczpcclxuICAgKlxyXG5gYGBodG1sXHJcbjxpbnB1dCBbbmdyeEZvcm1Db250cm9sU3RhdGVdPVwic3RhdGVcIlxyXG4gICAgICBbbmdyeEVuYWJsZUZvY3VzVHJhY2tpbmddPVwidHJ1ZVwiIC8+XHJcbmBgYFxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzRm9jdXNlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGNvbnRyb2wgY3VycmVudGx5IGRvZXMgbm90IGhhdmVcclxuICAgKiBmb2N1cyBvciBmb2N1cyB0cmFja2luZyBpcyBub3QgZW5hYmxlZCBmb3IgdGhlIGZvcm0gY29udHJvbC5cclxuICAgKi9cclxuICByZWFkb25seSBpc1VuZm9jdXNlZDogYm9vbGVhbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgdHlwZSByZXByZXNlbnRzIHRoZSBjaGlsZCBjb250cm9sIHN0YXRlcyBvZiBhIGZvcm0gZ3JvdXAuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBGb3JtR3JvdXBDb250cm9sczxUVmFsdWU+ID0ge1xyXG4gIHJlYWRvbmx5IFtjb250cm9sSWQgaW4ga2V5b2YgVFZhbHVlXTogRm9ybVN0YXRlPFRWYWx1ZVtjb250cm9sSWRdPjtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBGb3JtIGdyb3VwcyBhcmUgY29sbGVjdGlvbnMgb2YgbmFtZWQgY29udHJvbHMuIEp1c3QgbGlrZSBjb250cm9sc1xyXG4gKiBncm91cHMgYXJlIHJlcHJlc2VudGVkIGFzIHBsYWluIHN0YXRlIG9iamVjdHMuIFRoZSBzdGF0ZSBvZiBhXHJcbiAqIGdyb3VwIGlzIGRldGVybWluZWQgYWxtb3N0IGZ1bGx5IGJ5IGl0cyBjaGlsZCBzdGF0ZXMuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEZvcm1Hcm91cFN0YXRlPFRWYWx1ZSBleHRlbmRzIEtleVZhbHVlPiBleHRlbmRzIEFic3RyYWN0Q29udHJvbFN0YXRlPFRWYWx1ZT4ge1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhZ2dyZWdhdGVkIHZhbHVlIG9mIHRoZSBmb3JtIGdyb3VwLiBUaGUgdmFsdWUgaXMgY29tcHV0ZWQgYnlcclxuICAgKiBhZ2dyZWdhdGluZyB0aGUgdmFsdWVzIG9mIGFsbCBjaGlsZHJlbiwgZS5nLlxyXG4gICAqXHJcbmBgYHR5cGVzY3JpcHRcclxue1xyXG4gIGNoaWxkMTogJ3NvbWUgdmFsdWUnLFxyXG4gIGNoaWxkMjoge1xyXG4gICAgbmVzdGVkQ2hpbGQ6IDEwLFxyXG4gIH0sXHJcbn1cclxuYGBgXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgdmFsdWU6IFRWYWx1ZTtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gZ3JvdXAgZG9lcyBub3QgaGF2ZSBhbnkgZXJyb3JzXHJcbiAgICogaXRzZWxmIGFuZCBub25lIG9mIGl0cyBjaGlsZHJlbiBoYXZlIGFueSBlcnJvcnMuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNWYWxpZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gZ3JvdXAgb3IgYW55IG9mIGl0cyBjaGlsZHJlblxyXG4gICAqIGhhdmUgYXQgbGVhc3Qgb25lIGVycm9yLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzSW52YWxpZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIGVycm9ycyBvZiB0aGUgZm9ybSBncm91cC4gVGhpcyBwcm9wZXJ0eSBpcyBjb21wdXRlZCBieSBtZXJnaW5nXHJcbiAgICogdGhlIGVycm9ycyBvZiB0aGUgZ3JvdXAgd2l0aCB0aGUgZXJyb3JzIG9mIGFsbCBpdHMgY2hpbGRyZW4gd2hlcmVcclxuICAgKiB0aGUgY2hpbGQgZXJyb3JzIGFyZSBhIHByb3BlcnR5IG9mIHRoZSBgZXJyb3JzYCBvYmplY3QgcHJlZml4ZWQgd2l0aFxyXG4gICAqIGFuIHVuZGVyc2NvcmUsIGUuZy5cclxuICAgKlxyXG5gYGBcclxue1xyXG4gIGdyb3VwRXJyb3I6IHRydWUsXHJcbiAgX2NoaWxkOiB7XHJcbiAgICBjaGlsZEVycm9yOiB0cnVlLFxyXG4gIH0sXHJcbn1cclxuYGBgXHJcbiAgICpcclxuICAgKiBJZiBuZWl0aGVyIHRoZSBncm91cCBub3IgYW55IGNoaWxkcmVuIGhhdmUgZXJyb3JzIHRoZSBwcm9wZXJ0eSBpc1xyXG4gICAqIHNldCB0byBge31gLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGVycm9yczogVmFsaWRhdGlvbkVycm9ycztcclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIG5hbWVzIG9mIGFsbCBhc3luY2hyb25vdXMgdmFsaWRhdGlvbnMgY3VycmVudGx5IHJ1bm5pbmcgZm9yIHRoZVxyXG4gICAqIGZvcm0gZ3JvdXAuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgcGVuZGluZ1ZhbGlkYXRpb25zOiByZWFkb25seSBzdHJpbmdbXTtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpbmRpY2F0ZXMgd2hldGhlciB0aGUgZ3JvdXAgb3IgYW55IG9mIGl0cyBjaGlsZHJlblxyXG4gICAqIGFyZSBjdXJyZW50bHkgYmVpbmcgYXN5bmNocm9ub3VzbHkgdmFsaWRhdGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzVmFsaWRhdGlvblBlbmRpbmc6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGZvcm0gZ3JvdXAgaXMgZW5hYmxlZC4gSXQgaXNcclxuICAgKiBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYXQgbGVhc3Qgb25lIG9mIGl0cyBjaGlsZCBzdGF0ZXMgaXNcclxuICAgKiBlbmFibGVkLiBXaGVuIGl0IGlzIGBmYWxzZWAgdGhlIGBlcnJvcnNgIGFyZSBhbHdheXMgYHt9YCAoaS5lLlxyXG4gICAqIHRoZSBmb3JtIGdyb3VwIGlzIGFsd2F5cyB2YWxpZCBpZiBkaXNhYmxlZCkgYW5kIGBwZW5kaW5nVmFsaWRhdGlvbnNgXHJcbiAgICogaXMgYWx3YXlzIGBbXWAgKGkuZS4gYWxsIHBlbmRpbmcgdmFsaWRhdGlvbnMgYXJlIGNhbmNlbGxlZCkuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNFbmFibGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBmb3JtIGdyb3VwIGlzIGRpc2FibGVkLiBJdCBpc1xyXG4gICAqIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhbGwgb2YgaXRzIGNoaWxkIHN0YXRlIGFyZSBkaXNhYmxlZC4gV2hlblxyXG4gICAqIGl0IGlzIGB0cnVlYCB0aGUgYGVycm9yc2AgYXJlIGFsd2F5cyBge31gIChpLmUuIHRoZSBmb3JtIGdyb3VwXHJcbiAgICogaXMgYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2AgaXMgYWx3YXlzXHJcbiAgICogYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cclxuICAgKi9cclxuICByZWFkb25seSBpc0Rpc2FibGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhdCBsZWFzdCBvbmUgb2YgdGhlIGZvcm1cclxuICAgKiBncm91cCdzIGNoaWxkIHN0YXRlcyBpcyBtYXJrZWQgYXMgZGlydHkuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNEaXJ0eTogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYWxsIG9mIHRoZSBmb3JtIGdyb3VwJ3NcclxuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHByaXN0aW5lLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzUHJpc3RpbmU6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIGFuZCBvbmx5IGlmIGF0IGxlYXN0IG9uZSBvZiB0aGUgZm9ybVxyXG4gICAqIGdyb3VwJ3MgY2hpbGQgc3RhdGVzIGlzIG1hcmtlZCBhcyB0b3VjaGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzVG91Y2hlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYWxsIG9mIHRoZSBmb3JtIGdyb3VwJ3NcclxuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHVudG91Y2hlZC5cclxuICAgKi9cclxuICByZWFkb25seSBpc1VudG91Y2hlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBzZXQgdG8gYHRydWVgIGFzIHNvb24gYXMgdGhlIGZvcm0gZ3JvdXAgaXNcclxuICAgKiBzdWJtaXR0ZWQuIFRoaXMgaXMgdHJhY2tlZCBieSB0aGUgYE5ncnhGb3JtRGlyZWN0aXZlYCwgd2hpY2hcclxuICAgKiBuZWVkcyB0byBiZSBhcHBsaWVkIHRvIGEgZm9ybSBsaWtlIHRoaXM6XHJcbiAgICpcclxuYGBgaHRtbFxyXG48Zm9ybSBbbmdyeEZvcm1TdGF0ZV09XCJncm91cFN0YXRlXCI+XHJcbjwvZm9ybT5cclxuYGBgXHJcbiAgICpcclxuICAgKiBOb3RlIHRoYXQgYXBwbHlpbmcgdGhpcyBkaXJlY3RpdmUgdG8gYSBmb3JtIHByZXZlbnRzIG5vcm1hbCBmb3JtXHJcbiAgICogc3VibWlzc2lvbiBzaW5jZSB0aGF0IGRvZXMgbm90IG1ha2UgbXVjaCBzZW5zZSBmb3IgbmdyeCBmb3Jtcy5cclxuICAgKi9cclxuICByZWFkb25seSBpc1N1Ym1pdHRlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgYXMgbG9uZyBhcyB0aGUgc3RhdGUgaXMgbm90IHN1Ym1pdHRlZC5cclxuICAgKi9cclxuICByZWFkb25seSBpc1Vuc3VibWl0dGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGNvbnRhaW5zIGFsbCBjaGlsZCBzdGF0ZXMgb2YgdGhlIGZvcm0gZ3JvdXAuIEFzXHJcbiAgICogeW91IG1heSBoYXZlIG5vdGljZWQgdGhlIHR5cGUgb2YgZWFjaCBjaGlsZCBzdGF0ZSBpc1xyXG4gICAqIGBBYnN0cmFjdENvbnRyb2xTdGF0ZWAgd2hpY2ggc29tZXRpbWVzIGZvcmNlcyB5b3UgdG8gY2FzdCB0aGVcclxuICAgKiBzdGF0ZSBleHBsaWNpdGx5LiBJdCBpcyBub3QgcG9zc2libGUgdG8gaW1wcm92ZSB0aGlzIHR5cGluZ1xyXG4gICAqIHVudGlsIFtjb25kaXRpb25hbCBtYXBwZWQgdHlwZXNdKGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMTI0MjQpXHJcbiAgICogYXJlIGFkZGVkIHRvIFR5cGVTY3JpcHQuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgY29udHJvbHM6IEZvcm1Hcm91cENvbnRyb2xzPFRWYWx1ZT47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGb3JtIGFycmF5cyBhcmUgY29sbGVjdGlvbnMgb2YgY29udHJvbHMuIFRoZXkgYXJlIHJlcHJlc2VudGVkIGFzXHJcbiAqIHBsYWluIHN0YXRlIGFycmF5cy4gVGhlIHN0YXRlIG9mIGFuIGFycmF5IGlzIGRldGVybWluZWQgYWxtb3N0XHJcbiAqIGZ1bGx5IGJ5IGl0cyBjaGlsZCBzdGF0ZXMuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEZvcm1BcnJheVN0YXRlPFRWYWx1ZT4gZXh0ZW5kcyBBYnN0cmFjdENvbnRyb2xTdGF0ZTxyZWFkb25seSBUVmFsdWVbXT4ge1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhZ2dyZWdhdGVkIHZhbHVlIG9mIHRoZSBmb3JtIGFycmF5LiBUaGUgdmFsdWUgaXMgY29tcHV0ZWQgYnlcclxuICAgKiBhZ2dyZWdhdGluZyB0aGUgdmFsdWVzIG9mIGFsbCBjaGlsZHJlbiBpbnRvIGFuIGFycmF5LlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IHZhbHVlOiBUVmFsdWVbXTtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gYXJyYXkgZG9lcyBub3QgaGF2ZSBhbnkgZXJyb3JzXHJcbiAgICogaXRzZWxmIGFuZCBub25lIG9mIGl0cyBjaGlsZHJlbiBoYXZlIGFueSBlcnJvcnMuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNWYWxpZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgdGhlIGZvcm0gYXJyYXkgb3IgYW55IG9mIGl0cyBjaGlsZHJlblxyXG4gICAqIGhhdmUgYXQgbGVhc3Qgb25lIGVycm9yLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzSW52YWxpZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIGVycm9ycyBvZiB0aGUgZm9ybSBhcnJheS4gVGhpcyBwcm9wZXJ0eSBpcyBjb21wdXRlZCBieSBtZXJnaW5nXHJcbiAgICogdGhlIGVycm9ycyBvZiB0aGUgYXJyYXkgd2l0aCB0aGUgZXJyb3JzIG9mIGFsbCBpdHMgY2hpbGRyZW4gd2hlcmVcclxuICAgKiB0aGUgY2hpbGQgZXJyb3JzIGFyZSBhIHByb3BlcnR5IG9mIHRoZSBgZXJyb3JzYCBvYmplY3QgcHJlZml4ZWQgd2l0aFxyXG4gICAqIGFuIHVuZGVyc2NvcmUsIGUuZy5cclxuICAgKlxyXG5gYGBcclxue1xyXG4gIGFycmF5RXJyb3I6IHRydWUsXHJcbiAgXzA6IHtcclxuICAgIGNoaWxkRXJyb3I6IHRydWUsXHJcbiAgfSxcclxufVxyXG5gYGBcclxuICAgKlxyXG4gICAqIElmIG5laXRoZXIgdGhlIGFycmF5IG5vciBhbnkgY2hpbGRyZW4gaGF2ZSBlcnJvcnMgdGhlIHByb3BlcnR5IGlzXHJcbiAgICogc2V0IHRvIGB7fWAuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JzO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgbmFtZXMgb2YgYWxsIGFzeW5jaHJvbm91cyB2YWxpZGF0aW9ucyBjdXJyZW50bHkgcnVubmluZyBmb3IgdGhlXHJcbiAgICogZm9ybSBhcnJheS5cclxuICAgKi9cclxuICByZWFkb25seSBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGluZGljYXRlcyB3aGV0aGVyIHRoZSBhcnJheSBvciBhbnkgb2YgaXRzIGNoaWxkcmVuXHJcbiAgICogYXJlIGN1cnJlbnRseSBiZWluZyBhc3luY2hyb25vdXNseSB2YWxpZGF0ZWQuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNWYWxpZGF0aW9uUGVuZGluZzogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpbmRpY2F0ZXMgd2hldGhlciB0aGUgZm9ybSBhcnJheSBpcyBlbmFibGVkLiBJdCBpc1xyXG4gICAqIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhdCBsZWFzdCBvbmUgb2YgaXRzIGNoaWxkIHN0YXRlcyBpc1xyXG4gICAqIGVuYWJsZWQuIFdoZW4gaXQgaXMgYGZhbHNlYCB0aGUgYGVycm9yc2AgYXJlIGFsd2F5cyBge31gIChpLmUuXHJcbiAgICogdGhlIGZvcm0gYXJyYXkgaXMgYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2BcclxuICAgKiBpcyBhbHdheXMgYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cclxuICAgKi9cclxuICByZWFkb25seSBpc0VuYWJsZWQ6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGZvcm0gYXJyYXkgaXMgZGlzYWJsZWQuIEl0IGlzXHJcbiAgICogYHRydWVgIGlmIGFuZCBvbmx5IGlmIGFsbCBvZiBpdHMgY2hpbGQgc3RhdGVzIGFyZSBkaXNhYmxlZC4gV2hlblxyXG4gICAqIGl0IGlzIGB0cnVlYCB0aGUgYGVycm9yc2AgYXJlIGFsd2F5cyBge31gIChpLmUuIHRoZSBmb3JtIGFycmF5XHJcbiAgICogaXMgYWx3YXlzIHZhbGlkIGlmIGRpc2FibGVkKSBhbmQgYHBlbmRpbmdWYWxpZGF0aW9uc2AgaXMgYWx3YXlzXHJcbiAgICogYFtdYCAoaS5lLiBhbGwgcGVuZGluZyB2YWxpZGF0aW9ucyBhcmUgY2FuY2VsbGVkKS5cclxuICAgKi9cclxuICByZWFkb25seSBpc0Rpc2FibGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGlzIGB0cnVlYCBpZiBhbmQgb25seSBpZiBhdCBsZWFzdCBvbmUgb2YgdGhlIGZvcm1cclxuICAgKiBhcnJheSdzIGNoaWxkIHN0YXRlcyBpcyBtYXJrZWQgYXMgZGlydHkuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgaXNEaXJ0eTogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYWxsIG9mIHRoZSBmb3JtIGFycmF5J3NcclxuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHByaXN0aW5lLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzUHJpc3RpbmU6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgYHRydWVgIGlmIGFuZCBvbmx5IGlmIGF0IGxlYXN0IG9uZSBvZiB0aGUgZm9ybVxyXG4gICAqIGFycmF5J3MgY2hpbGQgc3RhdGVzIGlzIG1hcmtlZCBhcyB0b3VjaGVkLlxyXG4gICAqL1xyXG4gIHJlYWRvbmx5IGlzVG91Y2hlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgYWxsIG9mIHRoZSBmb3JtIGFycmF5J3NcclxuICAgKiBjaGlsZCBzdGF0ZXMgYXJlIHVudG91Y2hlZC5cclxuICAgKi9cclxuICByZWFkb25seSBpc1VudG91Y2hlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBzZXQgdG8gYHRydWVgIGFzIHNvb24gYXMgdGhlIGZvcm0gYXJyYXkgaXNcclxuICAgKiBzdWJtaXR0ZWQuIFRoaXMgaXMgdHJhY2tlZCBieSB0aGUgYE5ncnhGb3JtRGlyZWN0aXZlYCwgd2hpY2hcclxuICAgKiBuZWVkcyB0byBiZSBhcHBsaWVkIHRvIGEgZm9ybSBsaWtlIHRoaXM6XHJcbiAgICpcclxuYGBgaHRtbFxyXG48Zm9ybSBbbmdyeEZvcm1TdGF0ZV09XCJhcnJheVN0YXRlXCI+XHJcbjwvZm9ybT5cclxuYGBgXHJcbiAgICpcclxuICAgKiBOb3RlIHRoYXQgYXBwbHlpbmcgdGhpcyBkaXJlY3RpdmUgdG8gYSBmb3JtIHByZXZlbnRzIG5vcm1hbCBmb3JtXHJcbiAgICogc3VibWlzc2lvbiBzaW5jZSB0aGF0IGRvZXMgbm90IG1ha2UgbXVjaCBzZW5zZSBmb3IgbmdyeCBmb3Jtcy5cclxuICAgKi9cclxuICByZWFkb25seSBpc1N1Ym1pdHRlZDogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgYXMgbG9uZyBhcyB0aGUgc3RhdGUgaXMgbm90IHN1Ym1pdHRlZC5cclxuICAgKi9cclxuICByZWFkb25seSBpc1Vuc3VibWl0dGVkOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHByb3BlcnR5IGNvbnRhaW5zIGFsbCBjaGlsZCBzdGF0ZXMgb2YgdGhlIGZvcm0gYXJyYXkuIEFzXHJcbiAgICogeW91IG1heSBoYXZlIG5vdGljZWQgdGhlIHR5cGUgb2YgZWFjaCBjaGlsZCBzdGF0ZSBpc1xyXG4gICAqIGBBYnN0cmFjdENvbnRyb2xTdGF0ZWAgd2hpY2ggc29tZXRpbWVzIGZvcmNlcyB5b3UgdG8gY2FzdCB0aGVcclxuICAgKiBzdGF0ZSBleHBsaWNpdGx5LiBJdCBpcyBub3QgcG9zc2libGUgdG8gaW1wcm92ZSB0aGlzIHR5cGluZ1xyXG4gICAqIHVudGlsIFtjb25kaXRpb25hbCBtYXBwZWQgdHlwZXNdKGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMTI0MjQpXHJcbiAgICogYXJlIGFkZGVkIHRvIFR5cGVTY3JpcHQuXHJcbiAgICovXHJcbiAgcmVhZG9ubHkgY29udHJvbHM6IHJlYWRvbmx5IEZvcm1TdGF0ZTxUVmFsdWU+W107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGlzIGlzIGEgaGVscGVyIHR5cGUgdGhhdCBhbGxvd3Mgd29ya2luZyBhcm91bmQgdGhlIGRpc3RyaWJ1dGl2ZW5lc3NcclxuICogb2YgY29uZGl0aW9uYWwgdHlwZXMuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEluZmVyZW5jZVdyYXBwZXI8VD4ge1xyXG4gIHQ6IFQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGlzIGlzIGEgaGVscGVyIHR5cGUgdGhhdCBpbmZlcnMgdGhlIGNvcnJlY3QgZm9ybSBzdGF0ZSB0eXBlIGJhc2VkXHJcbiAqIG9uIHRoZSBib3hlZCB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBJbmZlcnJlZEJveGVkRm9ybVN0YXRlPFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGFueT4+ID1cclxuICBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxCb3hlZDxpbmZlciBVPj4gPyBGb3JtQ29udHJvbFN0YXRlPEJveGVkPFU+PlxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8Qm94ZWQ8aW5mZXIgVT4gfCB1bmRlZmluZWQ+ID8gRm9ybUNvbnRyb2xTdGF0ZTxCb3hlZDxVPiB8IHVuZGVmaW5lZD5cclxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPEJveGVkPGluZmVyIFU+IHwgbnVsbD4gPyBGb3JtQ29udHJvbFN0YXRlPEJveGVkPFU+IHwgbnVsbD5cclxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPEJveGVkPGluZmVyIFU+IHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBGb3JtQ29udHJvbFN0YXRlPEJveGVkPFU+IHwgdW5kZWZpbmVkIHwgbnVsbD5cclxuICA6IG5ldmVyXHJcbiAgO1xyXG5cclxuLyoqXHJcbiAqIFRoaXMgaXMgYSBoZWxwZXIgdHlwZSB0aGF0IGluZmVycyB0aGUgY29ycmVjdCBmb3JtIHN0YXRlIHR5cGUgYmFzZWRcclxuICogb24gdGhlIHN0cmluZyB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBJbmZlcnJlZFN0cmluZ0Zvcm1TdGF0ZTxUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxhbnk+PiA9XHJcbiAgVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8c3RyaW5nPiA/IEZvcm1Db250cm9sU3RhdGU8c3RyaW5nPlxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8c3RyaW5nIHwgdW5kZWZpbmVkPiA/IEZvcm1Db250cm9sU3RhdGU8c3RyaW5nIHwgdW5kZWZpbmVkPlxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8c3RyaW5nIHwgbnVsbD4gPyBGb3JtQ29udHJvbFN0YXRlPHN0cmluZyB8IG51bGw+XHJcbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8c3RyaW5nIHwgdW5kZWZpbmVkIHwgbnVsbD5cclxuICA6IG5ldmVyXHJcbiAgO1xyXG5cclxuLyoqXHJcbiAqIFRoaXMgaXMgYSBoZWxwZXIgdHlwZSB0aGF0IGluZmVycyB0aGUgY29ycmVjdCBmb3JtIHN0YXRlIHR5cGUgYmFzZWRcclxuICogb24gdGhlIG51bWJlciB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBJbmZlcnJlZE51bWJlckZvcm1TdGF0ZTxUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxhbnk+PiA9XHJcbiAgVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8bnVtYmVyPiA/IEZvcm1Db250cm9sU3RhdGU8bnVtYmVyPlxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8bnVtYmVyIHwgdW5kZWZpbmVkPiA/IEZvcm1Db250cm9sU3RhdGU8bnVtYmVyIHwgdW5kZWZpbmVkPlxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8bnVtYmVyIHwgbnVsbD4gPyBGb3JtQ29udHJvbFN0YXRlPG51bWJlciB8IG51bGw+XHJcbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8bnVtYmVyIHwgdW5kZWZpbmVkIHwgbnVsbD5cclxuICA6IG5ldmVyXHJcbiAgO1xyXG5cclxuLyoqXHJcbiAqIFRoaXMgaXMgYSBoZWxwZXIgdHlwZSB0aGF0IGluZmVycyB0aGUgY29ycmVjdCBmb3JtIHN0YXRlIHR5cGUgYmFzZWRcclxuICogb24gdGhlIGJvb2xlYW4gdHlwZSBjb250YWluZWQgaW4gdGhlIGluZmVyZW5jZSB3cmFwcGVyLlxyXG4gKi9cclxuZXhwb3J0IHR5cGUgSW5mZXJyZWRCb29sZWFuRm9ybVN0YXRlPFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGFueT4+ID1cclxuICBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxib29sZWFuPiA/IEZvcm1Db250cm9sU3RhdGU8Ym9vbGVhbj5cclxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGJvb2xlYW4gfCB1bmRlZmluZWQ+ID8gRm9ybUNvbnRyb2xTdGF0ZTxib29sZWFuIHwgdW5kZWZpbmVkPlxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8Ym9vbGVhbiB8IG51bGw+ID8gRm9ybUNvbnRyb2xTdGF0ZTxib29sZWFuIHwgbnVsbD5cclxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPGJvb2xlYW4gfCB1bmRlZmluZWQgfCBudWxsPiA/IEZvcm1Db250cm9sU3RhdGU8Ym9vbGVhbiB8IHVuZGVmaW5lZCB8IG51bGw+XHJcbiAgOiBuZXZlclxyXG4gIDtcclxuXHJcbi8qKlxyXG4gKiBUaGlzIGlzIGEgaGVscGVyIHR5cGUgdGhhdCBpbmZlcnMgdGhlIGNvcnJlY3QgZm9ybSBzdGF0ZSB0eXBlIGJhc2VkXHJcbiAqIG9uIHRoZSB0eXBlIGNvbnRhaW5lZCBpbiB0aGUgaW5mZXJlbmNlIHdyYXBwZXIuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBJbmZlcnJlZEZvcm1TdGF0ZTxUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxhbnk+PiA9XHJcbiAgLy8gKGFiKXVzZSAnc3ltYm9sJyB0byBjYXRjaCAnYW55JyB0eXBpbmdcclxuICBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxzeW1ib2w+ID8gQWJzdHJhY3RDb250cm9sU3RhdGU8YW55PlxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8dW5kZWZpbmVkPiA/IEFic3RyYWN0Q29udHJvbFN0YXRlPGFueT5cclxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPG51bGw+ID8gQWJzdHJhY3RDb250cm9sU3RhdGU8YW55PlxyXG5cclxuICAvLyBjb250cm9sXHJcbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxCb3hlZDxhbnk+IHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBJbmZlcnJlZEJveGVkRm9ybVN0YXRlPFQ+XHJcbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsPiA/IEluZmVycmVkU3RyaW5nRm9ybVN0YXRlPFQ+XHJcbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsPiA/IEluZmVycmVkTnVtYmVyRm9ybVN0YXRlPFQ+XHJcbiAgOiBUIGV4dGVuZHMgSW5mZXJlbmNlV3JhcHBlcjxib29sZWFuIHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBJbmZlcnJlZEJvb2xlYW5Gb3JtU3RhdGU8VD5cclxuXHJcbiAgLy8gYXJyYXlcclxuICA6IFQgZXh0ZW5kcyBJbmZlcmVuY2VXcmFwcGVyPHJlYWRvbmx5IChpbmZlciBVKVtdIHwgdW5kZWZpbmVkIHwgbnVsbD4gPyBGb3JtQXJyYXlTdGF0ZTxVPlxyXG5cclxuICAvLyBncm91cFxyXG4gIDogVCBleHRlbmRzIEluZmVyZW5jZVdyYXBwZXI8aW5mZXIgVSB8IHVuZGVmaW5lZCB8IG51bGw+ID8gRm9ybUdyb3VwU3RhdGU8VT5cclxuXHJcbiAgLy8gZmFsbGJhY2sgdHlwZSAodGhpcyBjYXNlIHNob3VsZCBuZXZlciAobm8gcHVuIGludGVuZGVkKSBiZSBoaXQpXHJcbiAgOiBuZXZlclxyXG4gIDtcclxuXHJcbi8qKlxyXG4gKiBUaGlzIGlzIGEgdHlwZSB0aGF0IGNhbiBpbmZlciB0aGUgY29uY3JldGUgdHlwZSBvZiBhIGZvcm0gc3RhdGUgYmFzZWRcclxuICogb24gdGhlIGdpdmVuIHR5cGUgcGFyYW1ldGVyLlxyXG4gKi9cclxuZXhwb3J0IHR5cGUgRm9ybVN0YXRlPFQ+ID0gSW5mZXJyZWRGb3JtU3RhdGU8SW5mZXJlbmNlV3JhcHBlcjxUPj47XHJcblxyXG4vKipcclxuICogVGhpcyBmdW5jdGlvbiBkZXRlcm1pbmVzIGlmIGEgdmFsdWUgaXMgYSBmb3JtIHN0YXRlLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzRm9ybVN0YXRlPFRWYWx1ZSA9IGFueT4oc3RhdGU6IGFueSk6IHN0YXRlIGlzIEZvcm1TdGF0ZTxUVmFsdWU+IHtcclxuICByZXR1cm4gISFzdGF0ZSAmJiBzdGF0ZS5oYXNPd25Qcm9wZXJ0eSgnaWQnKSAmJiBzdGF0ZS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSAmJiBzdGF0ZS5oYXNPd25Qcm9wZXJ0eSgnZXJyb3JzJyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGlzIGZ1bmN0aW9uIGRldGVybWluZXMgaWYgYSB2YWx1ZSBpcyBhbiBhcnJheSBzdGF0ZS5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0FycmF5U3RhdGU8VFZhbHVlID0gYW55PihzdGF0ZTogYW55KTogc3RhdGUgaXMgRm9ybUFycmF5U3RhdGU8VFZhbHVlPiB7XHJcbiAgcmV0dXJuIGlzRm9ybVN0YXRlKHN0YXRlKSAmJiBzdGF0ZS5oYXNPd25Qcm9wZXJ0eSgnY29udHJvbHMnKSAmJiBBcnJheS5pc0FycmF5KChzdGF0ZSBhcyBhbnkpLmNvbnRyb2xzKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyBpZiBhIHZhbHVlIGlzIGEgZ3JvdXAgc3RhdGUuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNHcm91cFN0YXRlPFRWYWx1ZSA9IGFueT4oc3RhdGU6IGFueSk6IHN0YXRlIGlzIEZvcm1Hcm91cFN0YXRlPFRWYWx1ZT4ge1xyXG4gIHJldHVybiBpc0Zvcm1TdGF0ZShzdGF0ZSkgJiYgc3RhdGUuaGFzT3duUHJvcGVydHkoJ2NvbnRyb2xzJykgJiYgIUFycmF5LmlzQXJyYXkoKHN0YXRlIGFzIGFueSkuY29udHJvbHMpICYmIHR5cGVvZiAoc3RhdGUgYXMgYW55KS5jb250cm9scyAhPT0gJ2Z1bmN0aW9uJztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNoaWxkU3RhdGU8VFZhbHVlPihpZDogc3RyaW5nLCBjaGlsZFZhbHVlOiBUVmFsdWUpOiBGb3JtU3RhdGU8VFZhbHVlPiB7XHJcbiAgaWYgKGlzQm94ZWQoY2hpbGRWYWx1ZSkpIHtcclxuICAgIHJldHVybiBjcmVhdGVGb3JtQ29udHJvbFN0YXRlPGFueT4oaWQsIGNoaWxkVmFsdWUpIGFzIEZvcm1TdGF0ZTxUVmFsdWU+O1xyXG4gIH1cclxuXHJcbiAgaWYgKGNoaWxkVmFsdWUgIT09IG51bGwgJiYgQXJyYXkuaXNBcnJheShjaGlsZFZhbHVlKSkge1xyXG4gICAgcmV0dXJuIGNyZWF0ZUZvcm1BcnJheVN0YXRlKGlkLCBjaGlsZFZhbHVlKSBhcyBGb3JtU3RhdGU8VFZhbHVlPjtcclxuICB9XHJcblxyXG4gIGlmIChjaGlsZFZhbHVlICE9PSBudWxsICYmIHR5cGVvZiBjaGlsZFZhbHVlID09PSAnb2JqZWN0Jykge1xyXG4gICAgcmV0dXJuIGNyZWF0ZUZvcm1Hcm91cFN0YXRlKGlkLCBjaGlsZFZhbHVlKSBhcyBGb3JtU3RhdGU8VFZhbHVlPjtcclxuICB9XHJcblxyXG4gIHJldHVybiBjcmVhdGVGb3JtQ29udHJvbFN0YXRlPGFueT4oaWQsIGNoaWxkVmFsdWUpIGFzIEZvcm1TdGF0ZTxUVmFsdWU+O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5Rm9ybUNvbnRyb2xWYWx1ZUlzVmFsaWQ8VFZhbHVlPih2YWx1ZTogVFZhbHVlKSB7XHJcbiAgaWYgKHZhbHVlID09PSBudWxsIHx8IFsnc3RyaW5nJywgJ251bWJlcicsICdib29sZWFuJywgJ3VuZGVmaW5lZCddLmluZGV4T2YodHlwZW9mIHZhbHVlKSA+PSAwKSB7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlzQm94ZWQodmFsdWUpKSB7XHJcbiAgICBjb25zdCBlcnJvck1zZyA9ICdGb3JtIGNvbnRyb2wgc3RhdGVzIG9ubHkgc3VwcG9ydCB1bmRlZmluZWQsIG51bGwsIHN0cmluZywgbnVtYmVyLCBhbmQgYm9vbGVhbiB2YWx1ZXMgYXMgd2VsbCBhcyBib3hlZCB2YWx1ZXMnO1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGAke2Vycm9yTXNnfTsgZ290ICR7SlNPTi5zdHJpbmdpZnkodmFsdWUpfSBvZiB0eXBlICR7dHlwZW9mIHZhbHVlfWApOyAvLyBgO1xyXG4gIH1cclxuXHJcbiAgaWYgKHZhbHVlLnZhbHVlID09PSBudWxsIHx8IFsnc3RyaW5nJywgJ251bWJlcicsICdib29sZWFuJywgJ3VuZGVmaW5lZCddLmluZGV4T2YodHlwZW9mIHZhbHVlLnZhbHVlKSA+PSAwKSB7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xyXG4gIGNvbnN0IGRlc2VyaWFsaXplZCA9IEpTT04ucGFyc2Uoc2VyaWFsaXplZCk7XHJcblxyXG4gIGlmIChkZWVwRXF1YWxzKHZhbHVlLCBkZXNlcmlhbGl6ZWQpKSB7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG5cclxuICB0aHJvdyBuZXcgRXJyb3IoYEEgZm9ybSBjb250cm9sIHZhbHVlIG11c3QgYmUgc2VyaWFsaXphYmxlIChpLmUuIHZhbHVlID09PSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHZhbHVlKSkpLCBnb3Q6ICR7SlNPTi5zdHJpbmdpZnkodmFsdWUpfWApO1xyXG59XHJcblxyXG4vKipcclxuICogVGhpcyBmdW5jdGlvbiBjcmVhdGVzIGEgZm9ybSBjb250cm9sIHN0YXRlIHdpdGggYW4gSUQgYW5kIGEgdmFsdWUuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRm9ybUNvbnRyb2xTdGF0ZTxUVmFsdWUgZXh0ZW5kcyBGb3JtQ29udHJvbFZhbHVlVHlwZXM+KFxyXG4gIGlkOiBOZ3J4Rm9ybUNvbnRyb2xJZCxcclxuICB2YWx1ZTogVFZhbHVlLFxyXG4pOiBGb3JtQ29udHJvbFN0YXRlPFRWYWx1ZT4ge1xyXG4gIHJldHVybiB7XHJcbiAgICBpZCxcclxuICAgIHZhbHVlOiB2ZXJpZnlGb3JtQ29udHJvbFZhbHVlSXNWYWxpZCh2YWx1ZSksXHJcbiAgICBlcnJvcnM6IHt9LFxyXG4gICAgcGVuZGluZ1ZhbGlkYXRpb25zOiBbXSxcclxuICAgIGlzVmFsaWRhdGlvblBlbmRpbmc6IGZhbHNlLFxyXG4gICAgaXNWYWxpZDogdHJ1ZSxcclxuICAgIGlzSW52YWxpZDogZmFsc2UsXHJcbiAgICBpc0VuYWJsZWQ6IHRydWUsXHJcbiAgICBpc0Rpc2FibGVkOiBmYWxzZSxcclxuICAgIGlzRGlydHk6IGZhbHNlLFxyXG4gICAgaXNQcmlzdGluZTogdHJ1ZSxcclxuICAgIGlzVG91Y2hlZDogZmFsc2UsXHJcbiAgICBpc1VudG91Y2hlZDogdHJ1ZSxcclxuICAgIGlzU3VibWl0dGVkOiBmYWxzZSxcclxuICAgIGlzVW5zdWJtaXR0ZWQ6IHRydWUsXHJcbiAgICBpc0ZvY3VzZWQ6IGZhbHNlLFxyXG4gICAgaXNVbmZvY3VzZWQ6IHRydWUsXHJcbiAgICB1c2VyRGVmaW5lZFByb3BlcnRpZXM6IHt9LFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGb3JtR3JvdXBWYWx1ZTxUVmFsdWUgZXh0ZW5kcyBLZXlWYWx1ZT4oXHJcbiAgY29udHJvbHM6IEZvcm1Hcm91cENvbnRyb2xzPFRWYWx1ZT4sXHJcbiAgb3JpZ2luYWxWYWx1ZTogVFZhbHVlLFxyXG4pOiBUVmFsdWUge1xyXG4gIGxldCBoYXNDaGFuZ2VkID0gT2JqZWN0LmtleXMob3JpZ2luYWxWYWx1ZSkubGVuZ3RoICE9PSBPYmplY3Qua2V5cyhjb250cm9scykubGVuZ3RoO1xyXG4gIGNvbnN0IG5ld1ZhbHVlID0gT2JqZWN0LmtleXMoY29udHJvbHMpLnJlZHVjZSgocmVzLCBrZXk6IGtleW9mIFRWYWx1ZSkgPT4ge1xyXG4gICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgb3JpZ2luYWxWYWx1ZVtrZXldICE9PSBjb250cm9sc1trZXldLnZhbHVlO1xyXG4gICAgcmVzW2tleV0gPSBjb250cm9sc1trZXldLnZhbHVlO1xyXG4gICAgcmV0dXJuIHJlcztcclxuICB9LCB7fSBhcyBUVmFsdWUpO1xyXG5cclxuICByZXR1cm4gaGFzQ2hhbmdlZCA/IG5ld1ZhbHVlIDogb3JpZ2luYWxWYWx1ZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvcm1Hcm91cEVycm9yczxUVmFsdWUgZXh0ZW5kcyBLZXlWYWx1ZT4oXHJcbiAgY29udHJvbHM6IEZvcm1Hcm91cENvbnRyb2xzPFRWYWx1ZT4sXHJcbiAgb3JpZ2luYWxFcnJvcnM6IFZhbGlkYXRpb25FcnJvcnMsXHJcbik6IFZhbGlkYXRpb25FcnJvcnMge1xyXG4gIGxldCBoYXNDaGFuZ2VkID0gZmFsc2U7XHJcbiAgY29uc3QgZ3JvdXBFcnJvcnMgPVxyXG4gICAgT2JqZWN0LmtleXMob3JpZ2luYWxFcnJvcnMpXHJcbiAgICAgIC5maWx0ZXIoa2V5ID0+ICFrZXkuc3RhcnRzV2l0aCgnXycpKVxyXG4gICAgICAucmVkdWNlKChyZXMsIGtleSkgPT4gT2JqZWN0LmFzc2lnbihyZXMsIHsgW2tleV06IG9yaWdpbmFsRXJyb3JzW2tleV0gfSksIHt9IGFzIFZhbGlkYXRpb25FcnJvcnMpO1xyXG5cclxuICBjb25zdCBuZXdFcnJvcnMgPSBPYmplY3Qua2V5cyhjb250cm9scykucmVkdWNlKChyZXMsIGtleTogYW55KSA9PiB7XHJcbiAgICBjb25zdCBjb250cm9sRXJyb3JzID0gY29udHJvbHNba2V5XS5lcnJvcnM7XHJcbiAgICBpZiAoIWlzRW1wdHkoY29udHJvbEVycm9ycykpIHtcclxuICAgICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgb3JpZ2luYWxFcnJvcnNbYF8ke2tleX1gXSAhPT0gY29udHJvbEVycm9ycztcclxuICAgICAgT2JqZWN0LmFzc2lnbihyZXMsIHsgW2BfJHtrZXl9YF06IGNvbnRyb2xzW2tleV0uZXJyb3JzIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgb3JpZ2luYWxFcnJvcnMuaGFzT3duUHJvcGVydHkoYF8ke2tleX1gKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzO1xyXG4gIH0sIGdyb3VwRXJyb3JzKTtcclxuXHJcbiAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgT2JqZWN0LmtleXMob3JpZ2luYWxFcnJvcnMpLmxlbmd0aCAhPT0gT2JqZWN0LmtleXMobmV3RXJyb3JzKS5sZW5ndGg7XHJcblxyXG4gIHJldHVybiBoYXNDaGFuZ2VkID8gbmV3RXJyb3JzIDogb3JpZ2luYWxFcnJvcnM7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlR3JvdXBTdGF0ZTxUVmFsdWUgZXh0ZW5kcyBLZXlWYWx1ZT4oXHJcbiAgaWQ6IHN0cmluZyxcclxuICBjb250cm9sczogRm9ybUdyb3VwQ29udHJvbHM8VFZhbHVlPixcclxuICB2YWx1ZTogVFZhbHVlLFxyXG4gIGVycm9yczogVmFsaWRhdGlvbkVycm9ycyxcclxuICBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdLFxyXG4gIHVzZXJEZWZpbmVkUHJvcGVydGllczogS2V5VmFsdWUsXHJcbiAgZmxhZ3M6IHtcclxuICAgIHdhc09yU2hvdWxkQmVEaXJ0eT86IGJvb2xlYW47XHJcbiAgICB3YXNPclNob3VsZEJlRW5hYmxlZD86IGJvb2xlYW47XHJcbiAgICB3YXNPclNob3VsZEJlVG91Y2hlZD86IGJvb2xlYW47XHJcbiAgICB3YXNPclNob3VsZEJlU3VibWl0dGVkPzogYm9vbGVhbjtcclxuICB9LFxyXG4pOiBGb3JtR3JvdXBTdGF0ZTxUVmFsdWU+IHtcclxuICB2YWx1ZSA9IGdldEZvcm1Hcm91cFZhbHVlPFRWYWx1ZT4oY29udHJvbHMsIHZhbHVlKTtcclxuICBlcnJvcnMgPSBnZXRGb3JtR3JvdXBFcnJvcnMoY29udHJvbHMsIGVycm9ycyk7XHJcbiAgY29uc3QgaXNWYWxpZCA9IGlzRW1wdHkoZXJyb3JzKTtcclxuICBjb25zdCBpc0RpcnR5ID0gZmxhZ3Mud2FzT3JTaG91bGRCZURpcnR5IHx8IE9iamVjdC5rZXlzKGNvbnRyb2xzKS5zb21lKGtleSA9PiBjb250cm9sc1trZXldLmlzRGlydHkpO1xyXG4gIGNvbnN0IGlzRW5hYmxlZCA9IGZsYWdzLndhc09yU2hvdWxkQmVFbmFibGVkIHx8IE9iamVjdC5rZXlzKGNvbnRyb2xzKS5zb21lKGtleSA9PiBjb250cm9sc1trZXldLmlzRW5hYmxlZCk7XHJcbiAgY29uc3QgaXNUb3VjaGVkID0gZmxhZ3Mud2FzT3JTaG91bGRCZVRvdWNoZWQgfHwgT2JqZWN0LmtleXMoY29udHJvbHMpLnNvbWUoa2V5ID0+IGNvbnRyb2xzW2tleV0uaXNUb3VjaGVkKTtcclxuICBjb25zdCBpc1N1Ym1pdHRlZCA9IGZsYWdzLndhc09yU2hvdWxkQmVTdWJtaXR0ZWQgfHwgT2JqZWN0LmtleXMoY29udHJvbHMpLnNvbWUoa2V5ID0+IGNvbnRyb2xzW2tleV0uaXNTdWJtaXR0ZWQpO1xyXG4gIGNvbnN0IGlzVmFsaWRhdGlvblBlbmRpbmcgPSBwZW5kaW5nVmFsaWRhdGlvbnMubGVuZ3RoID4gMCB8fCBPYmplY3Qua2V5cyhjb250cm9scykuc29tZShrZXkgPT4gY29udHJvbHNba2V5XS5pc1ZhbGlkYXRpb25QZW5kaW5nKTtcclxuICByZXR1cm4ge1xyXG4gICAgaWQsXHJcbiAgICB2YWx1ZSxcclxuICAgIGVycm9ycyxcclxuICAgIHBlbmRpbmdWYWxpZGF0aW9ucyxcclxuICAgIGlzVmFsaWRhdGlvblBlbmRpbmcsXHJcbiAgICBpc1ZhbGlkLFxyXG4gICAgaXNJbnZhbGlkOiAhaXNWYWxpZCxcclxuICAgIGlzRW5hYmxlZCxcclxuICAgIGlzRGlzYWJsZWQ6ICFpc0VuYWJsZWQsXHJcbiAgICBpc0RpcnR5LFxyXG4gICAgaXNQcmlzdGluZTogIWlzRGlydHksXHJcbiAgICBpc1RvdWNoZWQsXHJcbiAgICBpc1VudG91Y2hlZDogIWlzVG91Y2hlZCxcclxuICAgIGlzU3VibWl0dGVkLFxyXG4gICAgaXNVbnN1Ym1pdHRlZDogIWlzU3VibWl0dGVkLFxyXG4gICAgdXNlckRlZmluZWRQcm9wZXJ0aWVzLFxyXG4gICAgY29udHJvbHMsXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhIGZvcm0gZ3JvdXAgc3RhdGUgd2l0aCBhbiBJRCBhbmQgYSB2YWx1ZS5cclxuICogRnJvbSB0aGUgdmFsdWUgdGhlIHNoYXBlIG9mIHRoZSBncm91cCBzdGF0ZSBpcyBpbmZlcnJlZCwgaS5lLlxyXG4gKiBvYmplY3QgcHJvcGVydGllcyBhcmUgaW5mZXJyZWQgYXMgZm9ybSBncm91cHMsIGFycmF5IHByb3BlcnRpZXNcclxuICogYXJlIGluZmVycmVkIGFzIGZvcm0gYXJyYXlzLCBhbmQgcHJpbWl0aXZlIHByb3BlcnRpZXMgYXJlIGluZmVycmVkXHJcbiAqIGFzIGZvcm0gY29udHJvbHMuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRm9ybUdyb3VwU3RhdGU8VFZhbHVlIGV4dGVuZHMgS2V5VmFsdWU+KFxyXG4gIGlkOiBOZ3J4Rm9ybUNvbnRyb2xJZCxcclxuICBpbml0aWFsVmFsdWU6IFRWYWx1ZSxcclxuKTogRm9ybUdyb3VwU3RhdGU8VFZhbHVlPiB7XHJcbiAgY29uc3QgY29udHJvbHMgPSBPYmplY3Qua2V5cyhpbml0aWFsVmFsdWUpXHJcbiAgICAubWFwKChrZXk6IGtleW9mIFRWYWx1ZSkgPT4gW2tleSwgY3JlYXRlQ2hpbGRTdGF0ZShgJHtpZH0uJHtrZXl9YCwgaW5pdGlhbFZhbHVlW2tleV0pXSBhcyBbc3RyaW5nLCBGb3JtU3RhdGU8YW55Pl0pXHJcbiAgICAucmVkdWNlKChyZXMsIFtjb250cm9sSWQsIHN0YXRlXSkgPT4gT2JqZWN0LmFzc2lnbihyZXMsIHsgW2NvbnRyb2xJZF06IHN0YXRlIH0pLCB7fSBhcyBGb3JtR3JvdXBDb250cm9sczxUVmFsdWU+KTtcclxuXHJcbiAgcmV0dXJuIGNvbXB1dGVHcm91cFN0YXRlKGlkLCBjb250cm9scywgaW5pdGlhbFZhbHVlLCB7fSwgW10sIHt9LCB7IHdhc09yU2hvdWxkQmVFbmFibGVkOiB0cnVlIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRGb3JtQXJyYXlWYWx1ZTxUVmFsdWU+KFxyXG4gIGNvbnRyb2xzOiByZWFkb25seSBBYnN0cmFjdENvbnRyb2xTdGF0ZTxUVmFsdWU+W10sXHJcbiAgb3JpZ2luYWxWYWx1ZTogVFZhbHVlW10sXHJcbik6IFRWYWx1ZVtdIHtcclxuICBsZXQgaGFzQ2hhbmdlZCA9IE9iamVjdC5rZXlzKG9yaWdpbmFsVmFsdWUpLmxlbmd0aCAhPT0gT2JqZWN0LmtleXMoY29udHJvbHMpLmxlbmd0aDtcclxuICBjb25zdCBuZXdWYWx1ZSA9IGNvbnRyb2xzLm1hcCgoc3RhdGUsIGkpID0+IHtcclxuICAgIGhhc0NoYW5nZWQgPSBoYXNDaGFuZ2VkIHx8IG9yaWdpbmFsVmFsdWVbaV0gIT09IHN0YXRlLnZhbHVlO1xyXG4gICAgcmV0dXJuIHN0YXRlLnZhbHVlO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gaGFzQ2hhbmdlZCA/IG5ld1ZhbHVlIDogb3JpZ2luYWxWYWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Rm9ybUFycmF5RXJyb3JzPFRWYWx1ZT4oXHJcbiAgY29udHJvbHM6IHJlYWRvbmx5IEFic3RyYWN0Q29udHJvbFN0YXRlPFRWYWx1ZT5bXSxcclxuICBvcmlnaW5hbEVycm9yczogVmFsaWRhdGlvbkVycm9ycyxcclxuKTogVmFsaWRhdGlvbkVycm9ycyB7XHJcbiAgbGV0IGhhc0NoYW5nZWQgPSBmYWxzZTtcclxuICBjb25zdCBncm91cEVycm9ycyA9XHJcbiAgICBPYmplY3Qua2V5cyhvcmlnaW5hbEVycm9ycylcclxuICAgICAgLmZpbHRlcihrZXkgPT4gIWtleS5zdGFydHNXaXRoKCdfJykpXHJcbiAgICAgIC5yZWR1Y2UoKHJlcywga2V5KSA9PiBPYmplY3QuYXNzaWduKHJlcywgeyBba2V5XTogb3JpZ2luYWxFcnJvcnNba2V5XSB9KSwge30gYXMgVmFsaWRhdGlvbkVycm9ycyk7XHJcblxyXG4gIGNvbnN0IG5ld0Vycm9ycyA9IGNvbnRyb2xzLnJlZHVjZSgocmVzLCBzdGF0ZSwgaSkgPT4ge1xyXG4gICAgY29uc3QgY29udHJvbEVycm9ycyA9IHN0YXRlLmVycm9ycztcclxuICAgIGlmICghaXNFbXB0eShjb250cm9sRXJyb3JzKSkge1xyXG4gICAgICBoYXNDaGFuZ2VkID0gaGFzQ2hhbmdlZCB8fCBvcmlnaW5hbEVycm9yc1tgXyR7aX1gXSAhPT0gY29udHJvbEVycm9ycztcclxuICAgICAgT2JqZWN0LmFzc2lnbihyZXMsIHsgW2BfJHtpfWBdOiBjb250cm9sRXJyb3JzIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgb3JpZ2luYWxFcnJvcnMuaGFzT3duUHJvcGVydHkoYF8ke2l9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcztcclxuICB9LCBncm91cEVycm9ycyk7XHJcblxyXG4gIGhhc0NoYW5nZWQgPSBoYXNDaGFuZ2VkIHx8IE9iamVjdC5rZXlzKG9yaWdpbmFsRXJyb3JzKS5sZW5ndGggIT09IE9iamVjdC5rZXlzKG5ld0Vycm9ycykubGVuZ3RoO1xyXG5cclxuICByZXR1cm4gaGFzQ2hhbmdlZCA/IG5ld0Vycm9ycyA6IG9yaWdpbmFsRXJyb3JzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZUFycmF5U3RhdGU8VFZhbHVlPihcclxuICBpZDogc3RyaW5nLFxyXG4gIGluZmVycmVkQ29udHJvbHM6IHJlYWRvbmx5IEZvcm1TdGF0ZTxUVmFsdWU+W10sXHJcbiAgdmFsdWU6IFRWYWx1ZVtdLFxyXG4gIGVycm9yczogVmFsaWRhdGlvbkVycm9ycyxcclxuICBwZW5kaW5nVmFsaWRhdGlvbnM6IHJlYWRvbmx5IHN0cmluZ1tdLFxyXG4gIHVzZXJEZWZpbmVkUHJvcGVydGllczogS2V5VmFsdWUsXHJcbiAgZmxhZ3M6IHtcclxuICAgIHdhc09yU2hvdWxkQmVEaXJ0eT86IGJvb2xlYW47XHJcbiAgICB3YXNPclNob3VsZEJlRW5hYmxlZD86IGJvb2xlYW47XHJcbiAgICB3YXNPclNob3VsZEJlVG91Y2hlZD86IGJvb2xlYW47XHJcbiAgICB3YXNPclNob3VsZEJlU3VibWl0dGVkPzogYm9vbGVhbjtcclxuICB9LFxyXG4pOiBGb3JtQXJyYXlTdGF0ZTxUVmFsdWU+IHtcclxuICBjb25zdCBjb250cm9scyA9IGluZmVycmVkQ29udHJvbHMgYXMgcmVhZG9ubHkgQWJzdHJhY3RDb250cm9sU3RhdGU8YW55PltdO1xyXG5cclxuICB2YWx1ZSA9IGdldEZvcm1BcnJheVZhbHVlPFRWYWx1ZT4oY29udHJvbHMsIHZhbHVlKTtcclxuICBlcnJvcnMgPSBnZXRGb3JtQXJyYXlFcnJvcnMoY29udHJvbHMsIGVycm9ycyk7XHJcbiAgY29uc3QgaXNWYWxpZCA9IGlzRW1wdHkoZXJyb3JzKTtcclxuICBjb25zdCBpc0RpcnR5ID0gZmxhZ3Mud2FzT3JTaG91bGRCZURpcnR5IHx8IGNvbnRyb2xzLnNvbWUoc3RhdGUgPT4gc3RhdGUuaXNEaXJ0eSk7XHJcbiAgY29uc3QgaXNFbmFibGVkID0gZmxhZ3Mud2FzT3JTaG91bGRCZUVuYWJsZWQgfHwgY29udHJvbHMuc29tZShzdGF0ZSA9PiBzdGF0ZS5pc0VuYWJsZWQpO1xyXG4gIGNvbnN0IGlzVG91Y2hlZCA9IGZsYWdzLndhc09yU2hvdWxkQmVUb3VjaGVkIHx8IGNvbnRyb2xzLnNvbWUoc3RhdGUgPT4gc3RhdGUuaXNUb3VjaGVkKTtcclxuICBjb25zdCBpc1N1Ym1pdHRlZCA9IGZsYWdzLndhc09yU2hvdWxkQmVTdWJtaXR0ZWQgfHwgY29udHJvbHMuc29tZShzdGF0ZSA9PiBzdGF0ZS5pc1N1Ym1pdHRlZCk7XHJcbiAgY29uc3QgaXNWYWxpZGF0aW9uUGVuZGluZyA9IHBlbmRpbmdWYWxpZGF0aW9ucy5sZW5ndGggPiAwIHx8IGNvbnRyb2xzLnNvbWUoc3RhdGUgPT4gc3RhdGUuaXNWYWxpZGF0aW9uUGVuZGluZyk7XHJcbiAgcmV0dXJuIHtcclxuICAgIGlkLFxyXG4gICAgdmFsdWUsXHJcbiAgICBlcnJvcnMsXHJcbiAgICBwZW5kaW5nVmFsaWRhdGlvbnMsXHJcbiAgICBpc1ZhbGlkYXRpb25QZW5kaW5nLFxyXG4gICAgaXNWYWxpZCxcclxuICAgIGlzSW52YWxpZDogIWlzVmFsaWQsXHJcbiAgICBpc0VuYWJsZWQsXHJcbiAgICBpc0Rpc2FibGVkOiAhaXNFbmFibGVkLFxyXG4gICAgaXNEaXJ0eSxcclxuICAgIGlzUHJpc3RpbmU6ICFpc0RpcnR5LFxyXG4gICAgaXNUb3VjaGVkLFxyXG4gICAgaXNVbnRvdWNoZWQ6ICFpc1RvdWNoZWQsXHJcbiAgICBpc1N1Ym1pdHRlZCxcclxuICAgIGlzVW5zdWJtaXR0ZWQ6ICFpc1N1Ym1pdHRlZCxcclxuICAgIHVzZXJEZWZpbmVkUHJvcGVydGllcyxcclxuICAgIGNvbnRyb2xzOiBpbmZlcnJlZENvbnRyb2xzLFxyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGlzIGZ1bmN0aW9uIGNyZWF0ZXMgYSBmb3JtIGFycmF5IHN0YXRlIHdpdGggYW4gSUQgYW5kIGEgdmFsdWUuXHJcbiAqIEZyb20gdGhlIHZhbHVlIHRoZSBzaGFwZSBvZiB0aGUgYXJyYXkgc3RhdGUgaXMgaW5mZXJyZWQsIGkuZS5cclxuICogb2JqZWN0IHZhbHVlcyBhcmUgaW5mZXJyZWQgYXMgZm9ybSBncm91cHMsIGFycmF5IHZhbHVlc1xyXG4gKiBhcmUgaW5mZXJyZWQgYXMgZm9ybSBhcnJheXMsIGFuZCBwcmltaXRpdmUgdmFsdWVzIGFyZSBpbmZlcnJlZFxyXG4gKiBhcyBmb3JtIGNvbnRyb2xzLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUZvcm1BcnJheVN0YXRlPFRWYWx1ZT4oXHJcbiAgaWQ6IE5ncnhGb3JtQ29udHJvbElkLFxyXG4gIGluaXRpYWxWYWx1ZTogVFZhbHVlW10sXHJcbik6IEZvcm1BcnJheVN0YXRlPFRWYWx1ZT4ge1xyXG4gIGNvbnN0IGNvbnRyb2xzID0gaW5pdGlhbFZhbHVlXHJcbiAgICAubWFwKCh2YWx1ZSwgaSkgPT4gY3JlYXRlQ2hpbGRTdGF0ZShgJHtpZH0uJHtpfWAsIHZhbHVlKSk7XHJcblxyXG4gIHJldHVybiBjb21wdXRlQXJyYXlTdGF0ZShpZCwgY29udHJvbHMsIGluaXRpYWxWYWx1ZSwge30sIFtdLCB7fSwgeyB3YXNPclNob3VsZEJlRW5hYmxlZDogdHJ1ZSB9KTtcclxufVxyXG4iXX0=